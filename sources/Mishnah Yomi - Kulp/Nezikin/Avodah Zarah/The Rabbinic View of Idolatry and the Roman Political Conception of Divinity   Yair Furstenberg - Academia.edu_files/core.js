(function(){this.$image_url=function(e){return e.match(/^((https?:)?\/\/|\/)/)||(e="/images/"+e),e}}).call(this),this.JSON||(JSON={}),function(){function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e)),typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";return i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o,i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)r=rep[n],typeof r=="string"&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}else for(r in a)Object.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i));return i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o,i}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(e){return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z"},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}();var $r={};$r.__data={api_v0_analytics_hits:["api",["v0","analytics","hits"]],api_v0_analytics_graph:["api",["v0","analytics","graph"]],api_v0_attachments:["api",["v0","attachments"]],api_v0_attachment:["api",["v0","attachments",":id"]],api_v0_work_authorship:["api",["v0","works",":work_id","authorship"]],api_v0_work_attachments:["api",["v0","works",":work_id","attachments"]],new_api_v0_work_attachment:["api",["v0","works",":work_id","attachments","new"]],edit_api_v0_work_attachment:["api",["v0","works",":work_id","attachments",":id","edit"]],api_v0_work_attachment:["api",["v0","works",":work_id","attachments",":id"]],api_v0_works_views:["api",["v0","works","views"]],set_order_api_v0_works:["api",["v0","works","set_order"]],unstar_api_v0_work_stars:["api",["v0","works",":work_id","stars","unstar"]],api_v0_work_stars:["api",["v0","works",":work_id","stars"]],api_v0_works:["api",["v0","works"]],new_api_v0_work:["api",["v0","works","new"]],edit_api_v0_work:["api",["v0","works",":id","edit"]],api_v0_work:["api",["v0","works",":id"]],validate_api_v0_sections:["api",["v0","sections","validate"]],set_order_api_v0_sections:["api",["v0","sections","set_order"]],api_v0_section:["api",["v0","sections",":id"]],api_v0_user_details:["api",["v0","users",":user_id","details"]],api_v0_user_followers:["api",["v0","users",":user_id","followers"]],api_v0_user_following_index:["api",["v0","users",":user_id","following"]],api_v0_user_social_profiles:["api",["v0","users",":user_id","social_profiles"]],new_api_v0_user_social_profile:["api",["v0","users",":user_id","social_profiles","new"]],edit_api_v0_user_social_profile:["api",["v0","users",":user_id","social_profiles",":id","edit"]],api_v0_user_social_profile:["api",["v0","users",":user_id","social_profiles",":id"]],api_v0_user:["api",["v0","users",":id"]],add_api_v0_taggings:["api",["v0","taggings","add"]],remove_api_v0_taggings:["api",["v0","taggings","remove"]],set_order_api_v0_taggings:["api",["v0","taggings","set_order"]],inbox:["www",["inbox"]],sent_messages:["www",["sent_messages"]],read_message:["www",["read_message",":id"]],mark_as_spam_message:["www",["messages",":id","mark_as_spam"]],messages:["www",["messages"]],new_message:["www",["messages","new"]],edit_message:["www",["messages",":id","edit"]],message:["www",["messages",":id"]],sidebar_new_profile_activity:["www",[":page_name","Activity","sidebar"]],new_profile_activity:["www",[":page_name","Activity"]],email_new_profile_contact_details:["www",[":page_name","contact_details","email"]],new_profile_curriculum_vitae:["www",[":page_name","CurriculumVitae"]],new_profile_profile_picture:["www",[":page_name","ProfilePicture"]],new_profile_supervisors:["www",[":page_name","supervisors"]],bio_new_profile_about_box:["www",[":page_name","about_box","bio"]],supervisors_new_profile_about_box:["www",[":page_name","about_box","supervisors"]],new_profile_post_edit:["www",[":page_name","Posts",":post_id","edit"]],show_new_profile_post:["www",[":page_name","Posts",":id"]],new_profile_posts:["www",[":page_name","Posts"]],new_new_profile_post:["www",[":page_name","Posts","new"]],new_profile_post:["www",[":page_name","Posts",":id"]],new_profile_questions:["www",[":page_name","Questions"]],new_profile_answers:["www",[":page_name","Answers"]],new_profile_followers:["www",[":page_name","Followers"]],new_profile_following:["www",[":page_name","Following"]],import_new_profile:["www",[":page_name","Import"]],update_affiliation_new_profile:["www",[":page_name","update_affiliation"]],show_affiliation_new_profile:["www",[":page_name","show_affiliation"]],new_affiliation_new_profile:["www",[":page_name","new_affiliation"]],edit_affiliation_new_profile:["www",[":page_name","edit_affiliation"]],delete_affiliation_new_profile:["www",[":page_name","delete_affiliation"]],quick_affiliation_new_profile:["www",[":page_name","quick_affiliation"]],popup_affiliation_new_profile:["www",[":page_name","popup_affiliation"]],np_blog_post_post_redirect_new_profile:["www",[":page_name","Blog",":id",":slug"]],np_blog_post_no_slug_post_redirect_new_profile:["www",[":page_name","Blog",":id"]],status_updates_slug_post_redirect_new_profile:["www",[":page_name","StatusUpdates",":id",":slug"]],books_works_redirect_new_profile:["www",[":page_name","Books",":id"]],papers_works_redirect_new_profile:["www",[":page_name","Papers",":id"]],talks_works_redirect_new_profile:["www",[":page_name","Talks",":id"]],teachings_works_redirect_new_profile:["www",[":page_name","Teaching",":id"]],new_profile_works:["www",[":page_name",":section_name"]],new_profile:["www",[":page_name"]]},$r.__absolute=function(e,t){var t=t||{},n=this.__data[e][0],r=t.subdomain||n,i;return delete t.subdomain,i=this.__relative(e,t),t.host?"http://"+t.host+i:"http://"+r+"."+$app_host+i},$r.__relative=function(e,t){var n=this.__data[e][1],t=t||{},r=[],i=[],s="/",o;return $.each(n,function(e,n){var i;if(n.indexOf(":")==0){i=n.slice(1);if(!t[i])throw"Failed to provide component "+n+"!";r.push(t[i]),delete t[i]}else r.push(n)}),r.length>0&&(s+=r.join("/")),t.format&&(s=s+"."+t.format,delete t.format),t.anchor&&(o=t.anchor,delete t.anchor),$.each(t,function(e,t){i.push(e+"="+t)}),i.length>0&&(s=s+"?"+i.join("&")),o&&(s=s+"#"+o),s},$.each($r.__data,function(e,t){$r[e+"_url"]=function(t){return $r.__absolute(e,t)},$r[e+"_path"]=function(t){return $r.__relative(e,t)}}),function(e){e.fn.extend({autocomplete:function(t,n){var r=typeof t=="string";return n=e.extend({},e.Autocompleter.defaults,{url:r?t:null,data:r?null:t,delay:r?e.Autocompleter.defaults.delay:10,max:n&&!n.scroll?10:150},n),n.highlight=n.highlight||function(e){return e},n.formatMatch=n.formatMatch||n.formatItem,n.useSpace=n.useSpace||!1,this.each(function(){new e.Autocompleter(this,n)})},result:function(e){return this.bind("result",e)},search:function(e){return this.trigger("search",[e])},flushCache:function(){return this.trigger("flushCache")},setOptions:function(e){return this.trigger("setOptions",[e])},unautocomplete:function(){return this.trigger("unautocomplete")}}),e.Autocompleter=function(t,n){function d(){var e=c.selected();if(!e)return!1;var t=e.result;o=t;if(n.multiple){var r=m(i.val());r.length>1&&(t=r.slice(0,r.length-1).join(n.multipleSeparator)+n.multipleSeparator+t),t+=n.multipleSeparator}return i.val(n.displayItem(t)),w(),i.trigger("result",[e.data,e.value]),!0}function v(t,s,u,a){if(f==r.DEL){c.hide();return}var l;u!==undefined?l=u:l=i.val();if(!s&&l==o)return;o=l,l=g(l),l.length>=n.minChars||a?(i.addClass(n.loadingClass),n.matchCase||(l=l.toLowerCase()),n.distractor&&e(n.distractor).show(),S(l,E,w)):(T(),c.hide())}function m(t){if(!t)return[""];var r=t.split(n.multipleSeparator),i=[];return e.each(r,function(t,n){e.trim(n)&&(i[t]=e.trim(n))}),i}function g(e){if(!n.multiple)return e;var t=m(e);return t[t.length-1]}function y(s,u){n.autoFill&&g(i.val()).toLowerCase()==s.toLowerCase()&&f!=r.BACKSPACE&&(i.val(i.val()+u.substring(g(o).length)),e.Autocompleter.Selection(t,o.length,o.length+u.length))}function b(){clearTimeout(s),s=setTimeout(w,200)}function w(){var r=c.visible();c.hide(),clearTimeout(s),T(),n.mustMatch&&i.search(function(e){if(!e)if(n.multiple){var t=m(i.val()).slice(0,-1);i.val(t.join(n.multipleSeparator)+(t.length?n.multipleSeparator:""))}else i.val("")}),r&&e.Autocompleter.Selection(t,t.value.length,t.value.length),i.trigger("resultsHidden")}function E(e,t){t&&t.length&&a?(T(),c.display(t,e),y(e,t[0].value),c.show(),i.trigger("resultsShown")):w()}function S(r,i,s){n.matchCase||(r=r.toLowerCase());var o=u.load(r);if(o&&o.length)i(r,o);else if(typeof n.url=="string"&&n.url.length>0){var a={timestamp:+(new Date)};e.each(n.extraParams,function(e,t){a[e]=typeof t=="function"?t():t});var f=e.extend({q:g(r),limit:n.max},a);p!=null&&p.abort(),p=e.benchmarkedAjax({mode:"abort",port:"autocomplete"+t.name,dataType:n.dataType,url:n.url,benchmarkUrl:n.benchmarkUrl,data:f,benchmarkData:f,success:function(t){n.distractor&&e(n.distractor).hide(),n.requestCallback&&n.requestCallback(t);var s=n.parse&&n.parse(t)||x(t);u.add(r,s),i(r,s)}})}else n.distractor&&e(n.distractor).hide(),c.emptyList(),s(r)}function x(t){var r=[],i=t.split("\n");for(var s=0;s<i.length;s++){var o=e.trim(i[s]);o&&(o=o.split("|"),r[r.length]={data:o,value:o[0],result:n.formatResult&&n.formatResult(o,o[0])||o[0]})}return r}function T(){i.removeClass(n.loadingClass),p!=null&&(p.abort(),p=null),n.distractor&&e(n.distractor).hide()}function N(){v(0,!0)}var r={UP:38,DOWN:40,DEL:46,TAB:9,RETURN:13,ESC:27,COMMA:188,PAGEUP:33,PAGEDOWN:34,BACKSPACE:8},i=e(t).attr("autocomplete","off").addClass(n.inputClass),s,o="",u=e.Autocompleter.Cache(n),a=0,f,l={mouseDownOnSelect:!1},c=e.Autocompleter.Select(n,t,d,l);t.select_visible=function(){var e=c.visible();return typeof e!="undefined"&&e};var h,p=null;e.browser.opera&&e(t.form).bind("submit.autocomplete",function(){if(h)return h=!1,!1}),i.bind((e.browser.opera||e.browser.msie?"keypress":"keydown")+".autocomplete",function(e){return f=e.keyCode,e.keyCode==r.RETURN&&d()?(e.preventDefault(),h=!0,!1):!0}),i.bind((e.browser.opera?"keypress":"keydown")+".autocomplete",function(t){f=t.keyCode;switch(t.keyCode){case r.UP:c.visible()?(t.preventDefault(),c.prev()):v(0,!0);break;case r.DOWN:c.visible()?(t.preventDefault(),c.next()):v(0,!0);break;case r.PAGEUP:c.visible()?(t.preventDefault(),c.pageUp()):v(0,!0);break;case r.PAGEDOWN:c.visible()?(t.preventDefault(),c.pageDown()):v(0,!0);break;case n.multiple&&e.trim(n.multipleSeparator)==","&&r.COMMA:case r.TAB:if(d())return t.preventDefault(),h=!0,!1;break;case n.comma_effect&&r.COMMA:n.comma_effect();break;case r.ESC:c.hide(),i.trigger("resultsHidden");break;case n.useWordBoundaries&&(r.COMMA||r.SPACE||37||39||191||186||59||49):v(0,!0);break;default:clearTimeout(s),s=setTimeout(v,n.delay)}}).focus(function(){a++}).blur(function(){a=0,l.mouseDownOnSelect||b()}).click(function(){a++>1&&!c.visible()&&v(0,!0)}).bind("search",function(){function n(e,n){var r;if(n&&n.length)for(var s=0;s<n.length;s++)if(n[s].result.toLowerCase()==e.toLowerCase()){r=n[s];break}typeof t=="function"?t(r):i.trigger("result",r&&[r.data,r.value])}var t=arguments.length>1?arguments[1]:null;e.each(m(i.val()),function(e,t){S(t,n,n)})}).bind("flushCache",function(){u.flush()}).bind("setOptions",function(){e.extend(n,arguments[1]),"data"in arguments[1]&&u.populate()}).bind("unautocomplete",function(){c.unbind(),i.unbind(),e(t.form).unbind(".autocomplete")}).bind("forceSearch",function(){v(0,!0,"",!0)}).bind("hideResults",function(){b()}).bind("show_autocomplete",function(){N()})},e.Autocompleter.defaults={inputClass:"ac_input",resultsClass:"ac_results",loadingClass:"ac_loading",minChars:1,delay:400,matchCase:!1,matchSubset:!0,matchContains:!1,cacheLength:10,max:100,mustMatch:!1,extraParams:{},selectFirst:!0,formatItem:function(e){return e[0]},displayItem:function(e){return e},formatMatch:null,autoFill:!1,width:0,multiple:!1,multipleSeparator:", ",highlight:function(e,t){return t?e.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+t.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>"):e},scroll:!0,scrollHeight:180},e.Autocompleter.Cache=function(t){function i(e,n){t.matchCase||(e=e.toLowerCase());var r=e.indexOf(n);return t.matchContains=="word"&&(r=e.toLowerCase().search("\\b"+n.toLowerCase())),r==-1?!1:r==0||t.matchContains}function s(e,i){r>t.cacheLength&&u(),n[e]||r++,n[e]=i}function o(){if(!t.data)return!1;var n={},r=0;t.url||(t.cacheLength=1),n[""]=[];for(var i=0,o=t.data.length;i<o;i++){var u=t.data[i];u=typeof u=="string"?[u]:u;var a=t.formatMatch(u,i+1,t.data.length);if(a===!1)continue;var f=a.charAt(0).toLowerCase();n[f]||(n[f]=[]);var l={value:a,data:u,result:t.formatResult&&t.formatResult(u)||a};n[f].push(l),r++<t.max&&n[""].push(l)}e.each(n,function(e,n){t.cacheLength++,s(e,n)})}function u(){n={},r=0}var n={},r=0;return setTimeout(o,25),{flush:u,add:s,populate:o,load:function(s){if(!t.cacheLength||!r)return null;if(!t.url&&t.matchContains){var o=[];for(var u in n)if(u.length>0){var a=n[u];e.each(a,function(e,t){i(t.value,s)&&o.push(t)})}return o}if(n[s])return n[s];if(t.matchSubset)for(var f=s.length-1;f>=t.minChars;f--){var a=n[s.substr(0,f)];if(a){var o=[];return e.each(a,function(e,t){i(t.value,s)&&(o[o.length]=t)}),o}}return null}}},e.Autocompleter.Select=function(t,n,r,i){function p(){if(!l)return;c=e("<div/>").hide().addClass(t.resultsClass).css("position","absolute").appendTo(document.body),h=e("<ul/>").appendTo(c).mouseover(function(t){d(t).nodeName&&d(t).nodeName.toUpperCase()=="LI"&&(u=e("li",h).removeClass(s.ACTIVE).index(d(t)),e(d(t)).addClass(s.ACTIVE))}).click(function(t){return e(d(t)).addClass(s.ACTIVE),r(),n.focus(),!1}).mousedown(function(){i.mouseDownOnSelect=!0}).mouseup(function(){i.mouseDownOnSelect=!1}),t.form&&(view_all=e("<a>").attr({href:"#search","class":"view_all_results"}).html("View All Results").click(function(){return e(t.form).unbind("submit"),e(t.form).submit(),!1}),c.append(view_all)),t.width>0&&c.css("width",t.width),l=!1}function d(e){var t=e.target;while(t&&t.tagName!="LI")t=t.parentNode;return t?t:[]}function v(e){o.slice(u,u+1).removeClass(s.ACTIVE),m(e);var n=o.slice(u,u+1).addClass(s.ACTIVE);if(t.scroll){var r=0;o.slice(0,u).each(function(){r+=this.offsetHeight}),r+n[0].offsetHeight-h.scrollTop()>h[0].clientHeight?h.scrollTop(r+n[0].offsetHeight-h.innerHeight()):r<h.scrollTop()&&h.scrollTop(r)}}function m(e){u+=e,u<0?u=o.size()-1:u>=o.size()&&(u=0)}function g(e){return t.max&&t.max<e?t.max:e}function y(){h.empty();var n=g(a.length);for(var r=0;r<n;r++){if(!a[r])continue;var i=t.formatItem(a[r].data,r+1,n,a[r].value,f);if(i===!1)continue;var l=e("<li/>").html(t.highlight(i,f)).addClass(r%2==0?"ac_even":"ac_odd").appendTo(h)[0];e.data(l,"ac_data",a[r])}o=h.find("li"),t.selectFirst&&(o.slice(0,1).addClass(s.ACTIVE),u=0)}var s={ACTIVE:"ac_over"},o,u=-1,a,f="",l=!0,c,h;return{display:function(e,t){p(),a=e,f=t,y()},next:function(){v(1)},prev:function(){v(-1)},pageUp:function(){u!=0&&u-8<0?v(-u):v(-8)},pageDown:function(){u!=o.size()-1&&u+8>o.size()?v(o.size()-1-u):v(8)},hide:function(){c&&c.hide(),o&&o.removeClass(s.ACTIVE),u=-1},visible:function(){return c&&c.is(":visible")},current:function(){return this.visible()&&(o.filter("."+s.ACTIVE)[0]||t.selectFirst&&o[0])},show:function(){var r=e(n).offset();c.css({width:typeof t.width=="string"||t.width>0?t.width:e(n).width(),top:r.top+n.offsetHeight,left:r.left}).show();if(t.scroll){h.scrollTop(0),h.css({maxHeight:t.scrollHeight,overflow:"auto"});if(e.browser.msie&&typeof document.body.style.maxHeight=="undefined"){var i=0;o.each(function(){i+=this.offsetHeight});var s=i>t.scrollHeight;h.css("height",s?t.scrollHeight:i),s||o.width(h.width()-parseInt(o.css("padding-left"))-parseInt(o.css("padding-right")))}}},selected:function(){var t=o&&o.filter("."+s.ACTIVE).removeClass(s.ACTIVE);return t&&t.length&&e.data(t[0],"ac_data")},emptyList:function(){h&&h.empty()},unbind:function(){c&&c.remove()}}},e.Autocompleter.Selection=function(t,n,r){if(t.createTextRange){var i=t.createTextRange();i.collapse(!0),i.moveStart("character",n),i.moveEnd("character",r),i.select()}else t.setSelectionRange?t.setSelectionRange(n,r):t.selectionStart&&(t.selectionStart=n,t.selectionEnd=r);e(t).focus()}}(jQuery),function(e){var t="hidden",n="border-box",r="lineHeight",i='<textarea tabindex="-1" style="position:absolute; top:-9999px; left:-9999px; right:auto; bottom:auto; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden;"/>',s=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent"],o="oninput",u="onpropertychange",a=e(i)[0];a.setAttribute(o,"return"),e.isFunction(a[o])||u in a?(e(a).css(r,"99px"),e(a).css(r)==="99px"&&s.push(r),e.fn.autosize=function(r){return r=r||{},this.each(function(){function b(){var e,n,i;p||(p=!0,l.value=a.value,l.style.overflowY=a.style.overflowY,i=parseInt(a.style.height,10),l.style.width=f.css("width"),l.scrollTop=0,l.scrollTop=9e4,e=l.scrollTop,n=t,e>h?(e=h,n="scroll"):e<c&&(e=c),e+=m,a.style.overflowY=n,i!==e&&(a.style.height=e+"px",y&&r.callback.call(a)),setTimeout(function(){p=!1},1))}var a=this,f=e(a),l,c=f.height(),h=parseInt(f.css("maxHeight"),10),p,d=s.length,v,m=0,g=a.value,y=e.isFunction(r.callback);if(f.css("box-sizing")===n||f.css("-moz-box-sizing")===n||f.css("-webkit-box-sizing")===n)m=f.outerHeight()-f.height();if(f.data("mirror")||f.data("ismirror"))return;l=e(i).data("ismirror",!0).addClass(r.className||"autosizejs")[0],v=f.css("resize")==="none"?"none":"horizontal",f.data("mirror",e(l)).css({overflow:t,overflowY:t,wordWrap:"break-word",resize:v}),h=h&&h>0?h:9e4;while(d--)l.style[s[d]]=f.css(s[d]);e("body").append(l),u in a?o in a?a[o]=a.onkeyup=b:a[u]=b:a[o]=b,e(window).resize(b),f.bind("autosize",b),a.value="",a.value=g,b()})}):e.fn.autosize=function(e){return this}}(jQuery),jQuery.cookie=function(e,t,n){if(typeof t=="undefined"){var a=null;if(document.cookie&&document.cookie!=""){var f=document.cookie.split(";");for(var l=0;l<f.length;l++){var c=jQuery.trim(f[l]);if(c.substring(0,e.length+1)==e+"="){a=decodeURIComponent(c.substring(e.length+1));break}}}return a}n=n||{},t===null&&(t="",n=$.extend({},n),n.expires=-1);var r="";if(n.expires&&(typeof n.expires=="number"||n.expires.toUTCString)){var i;typeof n.expires=="number"?(i=new Date,i.setTime(i.getTime()+n.expires*24*60*60*1e3)):i=n.expires,r="; expires="+i.toUTCString()}var s=n.path?"; path="+n.path:"",o=n.domain?"; domain="+n.domain:"",u=n.secure?"; secure":"";document.cookie=[e,"=",encodeURIComponent(t),r,s,o,u].join("")},eval(function(e,t,n,r,i,s){i=function(e){return(e<t?"":i(parseInt(e/t)))+((e%=t)>35?String.fromCharCode(e+29):e.toString(36))};if(!"".replace(/^/,String)){while(n--)s[i(n)]=r[n]||i(n);r=[function(e){return s[e]}],i=function(){return"\\w+"},n=1}while(n--)r[n]&&(e=e.replace(new RegExp("\\b"+i(n)+"\\b","g"),r[n]));return e}("(5($){$.19={P:'1.2'};$.u(['j','w'],5(i,d){$.q['O'+d]=5(){p(!3[0])6;g a=d=='j'?'s':'m',e=d=='j'?'D':'C';6 3.B(':y')?3[0]['L'+d]:4(3,d.x())+4(3,'n'+a)+4(3,'n'+e)};$.q['I'+d]=5(b){p(!3[0])6;g c=d=='j'?'s':'m',e=d=='j'?'D':'C';b=$.F({t:Z},b||{});g a=3.B(':y')?3[0]['8'+d]:4(3,d.x())+4(3,'E'+c+'w')+4(3,'E'+e+'w')+4(3,'n'+c)+4(3,'n'+e);6 a+(b.t?(4(3,'t'+c)+4(3,'t'+e)):0)}});$.u(['m','s'],5(i,b){$.q['l'+b]=5(a){p(!3[0])6;6 a!=W?3.u(5(){3==h||3==r?h.V(b=='m'?a:$(h)['U'](),b=='s'?a:$(h)['T']()):3['l'+b]=a}):3[0]==h||3[0]==r?S[(b=='m'?'R':'Q')]||$.N&&r.M['l'+b]||r.A['l'+b]:3[0]['l'+b]}});$.q.F({z:5(){g a=0,f=0,o=3[0],8,9,7,v;p(o){7=3.7();8=3.8();9=7.8();8.f-=4(o,'K');8.k-=4(o,'J');9.f+=4(7,'H');9.k+=4(7,'Y');v={f:8.f-9.f,k:8.k-9.k}}6 v},7:5(){g a=3[0].7;G(a&&(!/^A|10$/i.16(a.15)&&$.14(a,'z')=='13'))a=a.7;6 $(a)}});5 4(a,b){6 12($.11(a.17?a[0]:a,b,18))||0}})(X);",62,72,"|||this|num|function|return|offsetParent|offset|parentOffset|||||borr|top|var|window||Height|left|scroll|Left|padding|elem|if|fn|document|Top|margin|each|results|Width|toLowerCase|visible|position|body|is|Right|Bottom|border|extend|while|borderTopWidth|outer|marginLeft|marginTop|client|documentElement|boxModel|inner|version|pageYOffset|pageXOffset|self|scrollTop|scrollLeft|scrollTo|undefined|jQuery|borderLeftWidth|false|html|curCSS|parseInt|static|css|tagName|test|jquery|true|dimensions".split("|"),0,{})),function(e){function t(){e.fn.ajaxSubmit.debug&&window.console&&window.console.log&&window.console.log("[jquery.form] "+Array.prototype.join.call(arguments,""))}e.fn.ajaxSubmit=function(n){function v(){function m(){if(c++)return;u.detachEvent?u.detachEvent("onload",m):u.removeEventListener("load",m,!1);var t=!0;try{if(h)throw"timeout";var n,i;i=u.contentWindow?u.contentWindow.document:u.contentDocument?u.contentDocument:u.document;if((i.body==null||i.body.innerHTML=="")&&!v){v=1,c--,setTimeout(m,100);return}a.responseText=i.body?i.body.innerHTML:null,a.responseXML=i.XMLDocument?i.XMLDocument:i,a.getResponseHeader=function(e){var t={"content-type":r.dataType};return t[e]};if(r.dataType=="json"||r.dataType=="script"){var s=i.getElementsByTagName("textarea")[0];a.responseText=s?s.value:a.responseText}else r.dataType=="xml"&&!a.responseXML&&a.responseText!=null&&(a.responseXML=g(a.responseText));n=e.httpData(a,r.dataType)}catch(f){t=!1,e.handleError(r,a,"error",f)}t&&(r.success(n,"success"),l&&e.event.trigger("ajaxSuccess",[a,r])),l&&e.event.trigger("ajaxComplete",[a,r]),l&&!--e.active&&e.event.trigger("ajaxStop"),r.complete&&r.complete(a,t?"success":"error"),setTimeout(function(){o.remove(),a.responseXML=null},100)}function g(e,t){return window.ActiveXObject?(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml"),t&&t.documentElement&&t.documentElement.tagName!="parsererror"?t:null}var t=f[0];if(e(":input[name=submit]",t).length){alert('Error: Form elements must not be named "submit".');return}var r=e.extend({},e.ajaxSettings,n),i=e.extend(!0,{},e.extend(!0,{},e.ajaxSettings),r),s="jqFormIO"+(new Date).getTime(),o=e('<iframe id="'+s+'" name="'+s+'" src="about:blank" />'),u=o[0];o.css({position:"absolute",top:"-1000px",left:"-1000px"});var a={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(){this.aborted=1,o.attr("src","about:blank")}},l=r.global;l&&!(e.active++)&&e.event.trigger("ajaxStart"),l&&e.event.trigger("ajaxSend",[a,r]);if(i.beforeSend&&i.beforeSend(a,i)===!1){i.global&&e.active--;return}if(a.aborted)return;var c=0,h=0,p=t.clk;if(p){var d=p.name;d&&!p.disabled&&(n.extraData=n.extraData||{},n.extraData[d]=p.value,p.type=="image"&&(n.extraData[name+".x"]=t.clk_x,n.extraData[name+".y"]=t.clk_y))}setTimeout(function(){var i=f.attr("target"),a=f.attr("action");t.setAttribute("target",s),t.getAttribute("method")!="POST"&&t.setAttribute("method","POST"),t.getAttribute("action")!=r.url&&t.setAttribute("action",r.url),n.skipEncodingOverride||f.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),r.timeout&&setTimeout(function(){h=!0,m()},r.timeout);var l=[];try{if(n.extraData)for(var c in n.extraData)l.push(e('<input type="hidden" name="'+c+'" value="'+n.extraData[c]+'" />').appendTo(t)[0]);o.appendTo("body"),u.attachEvent?u.attachEvent("onload",m):u.addEventListener("load",m,!1),t.submit()}finally{t.setAttribute("action",a),i?t.setAttribute("target",i):f.removeAttr("target"),e(l).remove()}},10);var v=0}if(!this.length)return t("ajaxSubmit: skipping submit process - no element selected"),this;typeof n=="function"&&(n={success:n});var r=this.attr("action")||window.location.href;r=(r.match(/^([^#]+)/)||[])[1],r=r||"",n=e.extend({url:r,type:this.attr("method")||"GET"},n||{});var i={};this.trigger("form-pre-serialize",[this,n,i]);if(i.veto)return t("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(n.beforeSerialize&&n.beforeSerialize(this,n)===!1)return t("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var s=this.formToArray(n.semantic);if(n.data){n.extraData=n.data;for(var o in n.data)if(n.data[o]instanceof Array)for(var u in n.data[o])s.push({name:o,value:n.data[o][u]});else s.push({name:o,value:n.data[o]})}if(n.beforeSubmit&&n.beforeSubmit(s,this,n)===!1)return t("ajaxSubmit: submit aborted via beforeSubmit callback"),this;this.trigger("form-submit-validate",[s,this,n,i]);if(i.veto)return t("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var a=e.param(s);n.type.toUpperCase()=="GET"?(n.url+=(n.url.indexOf("?")>=0?"&":"?")+a,n.data=null):n.data=a;var f=this,l=[];n.resetForm&&l.push(function(){f.resetForm()}),n.clearForm&&l.push(function(){f.clearForm()});if(!n.dataType&&n.target){var c=n.success||function(){};l.push(function(t){e(n.target).html(t).each(c,arguments)})}else n.success&&l.push(n.success);n.success=function(e,t){for(var r=0,i=l.length;r<i;r++)l[r].apply(n,[e,t,f])};var h=e("input:file",this).fieldValue(),p=!1;for(var d=0;d<h.length;d++)h[d]&&(p=!0);return n.iframe||p?n.closeKeepAlive?e.get(n.closeKeepAlive,v):v():e.ajax(n),this.trigger("form-submit-notify",[this,n]),this},e.fn.ajaxForm=function(t){return this.ajaxFormUnbind().bind("submit.form-plugin",function(){return e(this).ajaxSubmit(t),!1}).each(function(){e(":submit,input:image",this).bind("click.form-plugin",function(t){var n=this.form;n.clk=this;if(this.type=="image")if(t.offsetX!=undefined)n.clk_x=t.offsetX,n.clk_y=t.offsetY;else if(typeof e.fn.offset=="function"){var r=e(this).offset();n.clk_x=t.pageX-r.left,n.clk_y=t.pageY-r.top}else n.clk_x=t.pageX-this.offsetLeft,n.clk_y=t.pageY-this.offsetTop;setTimeout(function(){n.clk=n.clk_x=n.clk_y=null},10)})})},e.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin"),this.each(function(){e(":submit,input:image",this).unbind("click.form-plugin")})},e.fn.formToArray=function(t){var n=[];if(this.length==0)return n;var r=this[0],i=t?r.getElementsByTagName("*"):r.elements;if(!i)return n;for(var s=0,o=i.length;s<o;s++){var u=i[s],a=u.name;if(!a)continue;if(t&&r.clk&&u.type=="image"){!u.disabled&&r.clk==u&&n.push({name:a+".x",value:r.clk_x},{name:a+".y",value:r.clk_y});continue}var f=e.fieldValue(u,!0);if(f&&f.constructor==Array)for(var l=0,c=f.length;l<c;l++)n.push({name:a,value:f[l]});else f!==null&&typeof f!="undefined"&&n.push({name:a,value:f})}if(!t&&r.clk){var h=r.getElementsByTagName("input");for(var s=0,o=h.length;s<o;s++){var p=h[s],a=p.name;a&&!p.disabled&&p.type=="image"&&r.clk==p&&n.push({name:a+".x",value:r.clk_x},{name:a+".y",value:r.clk_y})}}return n},e.fn.formSerialize=function(t){return e.param(this.formToArray(t))},e.fn.fieldSerialize=function(t){var n=[];return this.each(function(){var r=this.name;if(!r)return;var i=e.fieldValue(this,t);if(i&&i.constructor==Array)for(var s=0,o=i.length;s<o;s++)n.push({name:r,value:i[s]});else i!==null&&typeof i!="undefined"&&n.push({name:this.name,value:i})}),e.param(n)},e.fn.fieldValue=function(t){for(var n=[],r=0,i=this.length;r<i;r++){var s=this[r],o=e.fieldValue(s,t);if(o===null||typeof o=="undefined"||o.constructor==Array&&!o.length)continue;o.constructor==Array?e.merge(n,o):n.push(o)}return n},e.fieldValue=function(e,t){var n=e.name,r=e.type,i=e.tagName.toLowerCase();typeof t=="undefined"&&(t=!0);if(t&&(!n||e.disabled||r=="reset"||r=="button"||(r=="checkbox"||r=="radio")&&!e.checked||(r=="submit"||r=="image")&&e.form&&e.form.clk!=e||i=="select"&&e.selectedIndex==-1))return null;if(i=="select"){var s=e.selectedIndex;if(s<0)return null;var o=[],u=e.options,a=r=="select-one",f=a?s+1:u.length;for(var l=a?s:0;l<f;l++){var c=u[l];if(c.selected){var h=c.value;h||(h=c.attributes&&c.attributes.value&&!c.attributes.value.specified?c.text:c.value);if(a)return h;o.push(h)}}return o}return e.value},e.fn.clearForm=function(){return this.each(function(){e("input,select,textarea",this).clearFields()})},e.fn.clearFields=e.fn.clearInputs=function(){return this.each(function(){var e=this.type,t=this.tagName.toLowerCase();e=="text"||e=="password"||t=="textarea"?this.value="":e=="checkbox"||e=="radio"?this.checked=!1:t=="select"&&(this.selectedIndex=-1)})},e.fn.resetForm=function(){return this.each(function(){(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType)&&this.reset()})},e.fn.enable=function(e){return e==undefined&&(e=!0),this.each(function(){this.disabled=!e})},e.fn.selected=function(t){return t==undefined&&(t=!0),this.each(function(){var n=this.type;if(n=="checkbox"||n=="radio")this.checked=t;else if(this.tagName.toLowerCase()=="option"){var r=e(this).parent("select");t&&r[0]&&r[0].type=="select-one"&&r.find("option").selected(!1),this.selected=t}})}}(jQuery),function(){$.fn.magicker_default=function(e){var t,n,r,i,s,o=this;return e?(n=!1,r=$("<div/>").text(e).css({position:"absolute",cursor:"text",color:"#999999"}).on("click",function(){return o.focus()}),t=function(){return o.val().length>0?i():s()},i=function(){return n=!1,r.hide()},s=function(){var i,s,u,a,f,l,c,h;(u=o.data("magicker-default"))&&u!==e&&(e=u,r.text(e));if(n)return;l=o.offsetParent(),a=o.offset(),c=l.offset();if(l.length===0){setTimeout(t,250);return}return n=!0,f={top:parseInt(o.css("padding-top")||"0"),left:parseInt(o.css("padding-left")||"0")},h=a.top-((c!=null?c.top:void 0)||0)+f.top+1,s=a.left-((c!=null?c.left:void 0)||0)+f.left+1,i=o.css("font"),r.css({top:h,left:s,font:i}).appendTo(l).show()},this.on("keyup focus blur",t),t(),this):this}}.call(this),function(){var e=[].slice;$.fn.more_link=function(){var t,n;return t=$.fn.more_link,n=arguments,$(this).each(function(r,i){return t.init.apply(t,[$(i)].concat(e.call(n)))})},$.fn.more_link.init=function(e,t,n,r){var i,s,o;return o=""+GlobalIncrementor.next()+"-"+(new Date).getTime(),s="more-link-container-"+o,e.attr("data-"+s,"true"),i=e.find(t),i.attr("data-more-link-behavior","true"),i.attr("data-container","*[data-"+s+"=true]"),i.attr("data-show",r),i.attr("data-hide",n)}}.call(this),function(e){e.fn.retina=function(t){var n={dataRetina:!0,suffix:"",checkIfImageExists:!1,customFileNameCallback:"",overridePixelRation:!1};t&&jQuery.extend(n,t);var r=!1;if(n.overridePixelRation||window.devicePixelRatio>=2)r=!0;return this.each(function(){var t=e(this);t.addClass("retina-off");if(!r)return!1;var i="";n.dataRetina&&t.attr("data-retina")&&(i=t.attr("data-retina")),n.suffix&&(i||(i=t.attr("src")));if(n.suffix){var s=i.replace(/.[^.]+$/,""),o=i.replace(/^.*\./,"");i=s+n.suffix+"."+o}n.customFileNameCallback&&(i=n.customFileNameCallback(t)),n.checkIfImageExists&&i?e.ajax({url:i,type:"HEAD",success:function(){t.attr("src",i),t.removeClass("retina-off"),t.addClass("retina-on")}}):i&&(t.attr("src"
,i),t.removeClass("retina-off"),t.addClass("retina-on"))})}}(jQuery),function(e){var t=function(e,t){return e<<t|e>>>32-t},n=function(e){var t="",n,r,i;for(n=0;n<=6;n+=2)r=e>>>n*4+4&15,i=e>>>n*4&15,t+=r.toString(16)+i.toString(16);return t},r=function(e){var t="",n,r;for(n=7;n>=0;n--)r=e>>>n*4&15,t+=r.toString(16);return t},i=function(e){e=e.replace(/\x0d\x0a/g,"\n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(r&63|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(r&63|128))}return t};e.extend({sha1:function(e){var n,s,o,u=new Array(80),a=1732584193,f=4023233417,l=2562383102,c=271733878,h=3285377520,p,d,v,m,g,y;e=i(e);var b=e.length,w=new Array;for(s=0;s<b-3;s+=4)o=e.charCodeAt(s)<<24|e.charCodeAt(s+1)<<16|e.charCodeAt(s+2)<<8|e.charCodeAt(s+3),w.push(o);switch(b%4){case 0:s=2147483648;break;case 1:s=e.charCodeAt(b-1)<<24|8388608;break;case 2:s=e.charCodeAt(b-2)<<24|e.charCodeAt(b-1)<<16|32768;break;case 3:s=e.charCodeAt(b-3)<<24|e.charCodeAt(b-2)<<16|e.charCodeAt(b-1)<<8|128}w.push(s);while(w.length%16!=14)w.push(0);w.push(b>>>29),w.push(b<<3&4294967295);for(n=0;n<w.length;n+=16){for(s=0;s<16;s++)u[s]=w[n+s];for(s=16;s<=79;s++)u[s]=t(u[s-3]^u[s-8]^u[s-14]^u[s-16],1);p=a,d=f,v=l,m=c,g=h;for(s=0;s<=19;s++)y=t(p,5)+(d&v|~d&m)+g+u[s]+1518500249&4294967295,g=m,m=v,v=t(d,30),d=p,p=y;for(s=20;s<=39;s++)y=t(p,5)+(d^v^m)+g+u[s]+1859775393&4294967295,g=m,m=v,v=t(d,30),d=p,p=y;for(s=40;s<=59;s++)y=t(p,5)+(d&v|d&m|v&m)+g+u[s]+2400959708&4294967295,g=m,m=v,v=t(d,30),d=p,p=y;for(s=60;s<=79;s++)y=t(p,5)+(d^v^m)+g+u[s]+3395469782&4294967295,g=m,m=v,v=t(d,30),d=p,p=y;a=a+p&4294967295,f=f+d&4294967295,l=l+v&4294967295,c=c+m&4294967295,h=h+g&4294967295}var y=r(a)+r(f)+r(l)+r(c)+r(h);return y.toLowerCase()}})}(jQuery),function(e){var t=function(e,t){return e<<t|e>>>32-t},n=function(e){var t="",n,r,i;for(n=0;n<=6;n+=2)r=e>>>n*4+4&15,i=e>>>n*4&15,t+=r.toString(16)+i.toString(16);return t},r=function(e){var t="",n,r;for(n=7;n>=0;n--)r=e>>>n*4&15,t+=r.toString(16);return t},i=function(e){e=e.replace(/\x0d\x0a/g,"\n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(r&63|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(r&63|128))}return t};e.extend({sha1:function(e){var n,s,o,u=new Array(80),a=1732584193,f=4023233417,l=2562383102,c=271733878,h=3285377520,p,d,v,m,g,y;e=i(e);var b=e.length,w=new Array;for(s=0;s<b-3;s+=4)o=e.charCodeAt(s)<<24|e.charCodeAt(s+1)<<16|e.charCodeAt(s+2)<<8|e.charCodeAt(s+3),w.push(o);switch(b%4){case 0:s=2147483648;break;case 1:s=e.charCodeAt(b-1)<<24|8388608;break;case 2:s=e.charCodeAt(b-2)<<24|e.charCodeAt(b-1)<<16|32768;break;case 3:s=e.charCodeAt(b-3)<<24|e.charCodeAt(b-2)<<16|e.charCodeAt(b-1)<<8|128}w.push(s);while(w.length%16!=14)w.push(0);w.push(b>>>29),w.push(b<<3&4294967295);for(n=0;n<w.length;n+=16){for(s=0;s<16;s++)u[s]=w[n+s];for(s=16;s<=79;s++)u[s]=t(u[s-3]^u[s-8]^u[s-14]^u[s-16],1);p=a,d=f,v=l,m=c,g=h;for(s=0;s<=19;s++)y=t(p,5)+(d&v|~d&m)+g+u[s]+1518500249&4294967295,g=m,m=v,v=t(d,30),d=p,p=y;for(s=20;s<=39;s++)y=t(p,5)+(d^v^m)+g+u[s]+1859775393&4294967295,g=m,m=v,v=t(d,30),d=p,p=y;for(s=40;s<=59;s++)y=t(p,5)+(d&v|d&m|v&m)+g+u[s]+2400959708&4294967295,g=m,m=v,v=t(d,30),d=p,p=y;for(s=60;s<=79;s++)y=t(p,5)+(d^v^m)+g+u[s]+3395469782&4294967295,g=m,m=v,v=t(d,30),d=p,p=y;a=a+p&4294967295,f=f+d&4294967295,l=l+v&4294967295,c=c+m&4294967295,h=h+g&4294967295}var y=r(a)+r(f)+r(l)+r(c)+r(h);return y.toLowerCase()}})}(jQuery),function(e){function n(){var t=r(this);return isNaN(t.datetime)||e(this).text(i(t.datetime)),this}function r(n){n=e(n);if(!n.data("timeago")){n.data("timeago",{datetime:t.datetime(n)});var r=e.trim(n.text());r.length>0&&n.attr("title",r)}return n.data("timeago")}function i(e){return t.inWords(s(e))}function s(e){return(new Date).getTime()-e.getTime()}e.timeago=function(t){return t instanceof Date?i(t):typeof t=="string"?i(e.timeago.parse(t)):i(e.timeago.datetime(t))};var t=e.timeago;e.extend(e.timeago,{settings:{refreshMillis:6e4,allowFuture:!1,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",numbers:[]}},inWords:function(t){function l(r,i){var s=e.isFunction(r)?r(i,t):r,o=n.numbers&&n.numbers[i]||i;return s.replace(/%d/i,o)}var n=this.settings.strings,r=n.prefixAgo,i=n.suffixAgo;this.settings.allowFuture&&t<0&&(r=n.prefixFromNow,i=n.suffixFromNow);var s=Math.abs(t)/1e3,o=s/60,u=o/60,a=u/24,f=a/365,c=s<45&&l(n.seconds,Math.round(s))||s<90&&l(n.minute,1)||o<45&&l(n.minutes,Math.round(o))||o<90&&l(n.hour,1)||u<24&&l(n.hours,Math.round(u))||u<48&&l(n.day,1)||a<30&&l(n.days,Math.floor(a))||a<60&&l(n.month,1)||a<365&&l(n.months,Math.floor(a/30))||f<2&&l(n.year,1)||l(n.years,Math.floor(f));return e.trim([r,c,i].join(" "))},parse:function(t){var n=e.trim(t);return n=n.replace(/\.\d\d\d+/,""),n=n.replace(/-/,"/").replace(/-/,"/"),n=n.replace(/T/," ").replace(/Z/," UTC"),n=n.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),new Date(n)},datetime:function(n){var r=e(n).get(0).tagName.toLowerCase()==="time",i=r?e(n).attr("datetime"):e(n).attr("title");return t.parse(i)}}),e.fn.timeago=function(){var e=this;e.each(n);var r=t.settings;return r.refreshMillis>0&&setInterval(function(){e.each(n)},r.refreshMillis),e},document.createElement("abbr"),document.createElement("time")}(jQuery),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>>>0,n=Number(arguments[1])||0;n=n<0?Math.ceil(n):Math.floor(n),n<0&&(n+=t);for(;n<t;n+=1)if(n in this&&this[n]===e)return n;return-1});var m={},v={},c={},URLs={},$x={ensureNamespace:function(e){c[e]||(c[e]={}),v[e]||(v[e]={})},convertPipe:function(e){return e.replace(/&#124;/g,"|")},getOwnPropertiesWithoutMethods:function(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&typeof e[t]!="function"&&n.push(t);return n},getOwnProperties:function(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(t);return n},cloneWithoutMethods:function(e){return $x.extendOnly({},e,$x.getOwnPropertiesWithoutMethods(e))},extendOnly:function(e,t,n){var r,i;for(r=0;r<n.length;r+=1)i=n[r],e[i]=t[i];return e},extend:function(e,t){return $x.extendOnly(e,t,$x.getOwnProperties(t))},clone:function(e){if(null==e||"object"!=typeof e)return e;if(e instanceof Date){var t=new Date;return t.setTime(e.getTime()),t}if(e instanceof Array){var t=[];for(var n=0,r=e.length;n<r;++n)t[n]=$x.clone(e[n]);return t}if(e instanceof Object){var t={};for(var i in e)e.hasOwnProperty(i)&&(t[i]=$x.clone(e[i]));return t}throw new Error("Unable to copy obj! Its type isn't supported.")},object:function(e){function t(){}t.prototype=e;var n=new t;return n._parent=e,n}},$_x={extend:function(e){var t=function(){t.__super__.constructor.apply(this,arguments)},n=Object.prototype.hasOwnProperty,r=function(){this.constructor=t};for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t}},$e={call_and_report_errors:function(e,t){try{e()}catch(n){$e.report_error(n.message,n.stack,t)}},report_error:function(e,t,n,r){try{var i="unknown";if(typeof deconcept!="undefined"){var s=deconcept.SWFObjectUtil.getPlayerVersion();i=s.major+"."+s.minor+"."+s.rev}$.post("/report_client_side_error",{client_type:"Javascript",tag:n,error_message:e,trace:t,version_info:"",flash_version:i})}catch(o){}r||alert("Oops... Something just went wrong!\n\nWe're taking a look at the issue right now.")}},$f={auto_copy_field:function(e,t,n,r){var i=function(){var s=e.val(),o=t.val();s!==o&&(!o||!n)&&t.val(s),n&&e.unbind("change",i),r&&r()};e.change(i)}},Base={inherit:function(e){var t=$x.extend($x.object(this),e);return t},protocall:function(){var e=arguments[0],t;if(this.hasOwnProperty(e))t=this.prototype_that_defines(e);else{var n=this.prototype_that_defines(e);"undefined"!=typeof n&&(t=n._parent)}if("undefined"!=typeof t){var r=[];for(var i=1;i<arguments.length;i+=1)r.push(arguments[i]);return t[e].apply(this,r)}return undefined},prototype_that_defines:function(e){var t=this._parent;while("undefined"!=typeof t&&!t.hasOwnProperty(e))t=t._parent;return t},create:function(){var e=$x.object(this);return e.init.apply(e,arguments),e},init:function(){return this}},BaseController=Base.inherit({_ref:null,init:function(e){var t=this;return this.options=e||{},$(document).ready(function(){t.init_elements(),t.init_behaviors(),typeof t.options.after_initialize!="undefined"&&t.options.after_initialize.call(t,t)}),this},init_elements:function(){this.options.elements?this.set_elements(this.options.elements):this.elements={}},set_elements:function(e){var t=this;return t.elements={},_.each($x.getOwnProperties(e),function(n){t.elements[n]=$(e[n])}),t},init_behaviors:function(){return this}}),BaseView=Base.inherit({init:function(e){typeof e=="string"?this.container=$(e):this.container=e},show:function(){var e=JSML.transform(this.structure.apply(this,Array.prototype.slice.call(arguments)));this.container.html(""),this.container.get(0).appendChild(e),this.container.show()},structure:function(){},scroll_to:function(e){"undefined"===e&&(e=400);var t=$(this.container).offset(),n=$(window).height(),r=t-20;r<20&&(r=0),$("html,body").animate({scrollTop:r},e)}}),$h={singularize:function(e){return e.match(/(x|z|ch|sh|ss)es$/)?e.substring(0,e.length-2):e.match(/s$/)?e.substring(0,e.length-1):e},pluralize:function(e){return e==""?e:e.match(/(x|z|ch|sh|ss)$/)?e+"es":e.match(/s$/)?e:e+"s"},capitalize:function(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()},decodeHTML:function(e){var t=document.createElement("div");return t.innerHTML=e,t.childNodes[0].nodeValue},encodeHTML:function(e){return $("<div/>").text(e).html()},time_ago_in_words:function(e,t){return"undefined"==typeof t&&(t=!0),$h.distance_of_time_in_words(new Date,e,t)+" ago"},time_to_go_in_words:function(e,t){return"undefined"==typeof t&&(t=!0),"in "+$h.distance_of_time_in_words(new Date,e,t)},distance_of_time_in_words:function(e,t,n){var r=e.getTime(),i=t.getTime(),s=Math.round(Math.abs(r-i)/1e3),o=Math.round(s/60);return o<=1?n?s<5?"less than 5 seconds":s<10?"less than 10 seconds":s<20?"less than 20 seconds":s<40?"half a minute":s<60?"less than a minute":"1 minute":o===0?"less than a minute":"1 minute":o<45?o+" minutes":o<90?"about 1 hour":o<1440?"about "+Math.round(o/60)+" hours":o<2880?"1 day":o<43200?Math.round(o/1440)+" days":o<86400?"about 1 month":o<525600?Math.round(o/43200)+" months":o<1051200?"about 1 year":"over "+Math.round(o/525600)+" years"},ipad_user:function(){return navigator.userAgent.match(/iPad/i)!=null},formatted_date:function(e){var t=["th","st","nd","rd"];_.isDate(e)||(e=new Date(e));var n=["January","February","March","April","May","June","July","August","September","October","November","December"],r=e.getUTCDate()%100,i=t[(r-20)%10]||t[r]||t[0];return r+i+" "+n[e.getUTCMonth()]},truncate:function(e,t){return e.length>t?e.slice(0,t-3)+"...":e},to_sentence:function(e){switch(e.length){case 0:return"";case 1:return""+e[0];case 2:return""+e[0]+" and "+e[1];default:return""+e.slice(0,-1).join(", ")+" and "+e.slice(-1)}}},Prefs={set_for_user:function(e,t,n,r){t.user_id=e,$("#post-profile-to-facebook").slideUp(),$.post("/set_user_preferences",t,function(e){e.success?n&&n():r?r():document.location="/login"},"json")},simple_set_for_user:function(e,t,n){var r=null,i=null;if(n){var s=$(n);s.find(".saved").hide(),s.find(".failed").hide(),s.find(".saving").show(),s.show(),r=function(){s.find(".saving").hide(),s.find(".saved").show(),s.fadeOut(1e3)},i=function(){s.find(".saving").hide(),s.find(".failed").show(),s.fadeOut(1e3)}}this.set_for_user(e,t,r,i)}};$.fn.flash=function(){this.each(function(){var e=$(this).css("backgroundColor");$(this).animate({backgroundColor:"#FFFF00"},500,"linear",function(){$(this).animate({backgroundColor:e},1e3)})})},$.fn.single_click=function(e){var t=this,n=function(){return!1},r=function(i){var s=this;return t.unbind("click",r),t.click(n),setTimeout(function(){t.unbind("click",n),t.click(r)},1e3),e.call(s,i)};return t.click(r)},$.fn.single_submit=function(e){var t=this,n=t.find("[type=submit]");e||(e=1e3),t.bind("submit",function(){n.attr("disabled",!0),setTimeout(function(){n.attr("disabled",!1)},e)})},$.fn.single_submit_with_callback=function(e){var t=this,n=t.find("[type=submit]"),r,i,s;r=function(){t.unbind("submit",s),t.bind("submit",!1),n.attr("disabled",!0)},i=function(){t.unbind("submit",!1),t.bind("submit",s),n.attr("disabled",!1)},s=function(t){return r(),e.call(this,t,i)},t.bind("submit",s)},$.fn.serializeObject=function(){var e={},t=this.serializeArray();return $.each(t,function(){e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e},$.fn.serializeNestedObject=function(){var e=this.serializeObject(),t={};return $.each(e,function(e,n){var r=_.compact(e.split(/[\[\]]/)),i=t,s;while(r.length>1){part=r.shift();if(typeof i[part]=="undefined")i=i[part]={};else{if(typeof i[part]!="object")throw"incorrect nesting!";i=i[part]}}part=r.shift(),i[part]=n}),t},$.benchmarkReported={},$.benchmarkedAjax=function(e){var t=null,n=null,r=null,i=null;e.url&&(i=e.url.split("?")[0]);var s=e.beforeSend;e.beforeSend=function(e){n=new Date,s&&s.call(this,e)};var o=e.success;e.success=function(s,u){r=new Date;var a=r-n,f=t.getResponseHeader("X-Runtime");!$.benchmarkReported[i]&&e.benchmarkUrl&&$.ajax({url:e.benchmarkUrl,type:"POST",dataType:"json",data:$.extend(e.benchmarkData,{url:i,response_time:a,render_time:f,_method:"PUT"}),success:function(e){$.benchmarkReported[i]=!0}}),o&&o.call(this,s,u)};var u=e.complete;return e.complete=function(e){n=null,r=null,u&&u.call(this,e)},t=$.ajax(e),t},function(){var e=[].slice;this.$a={is_logged_in:function(){return"undefined"!=typeof $current_user},is_owner:function(){return this.is_logged_in()&&"undefined"!=typeof $viewed_user&&$viewed_user.id===$current_user.id},is_admin:function(){return this.is_logged_in()&&$current_user.admin===!0},has_qanda:function(){return this.is_logged_in()&&$current_user.qa===!0},log:function(){if("undefined"!=typeof console&&console.log&&console.log.apply)return console.log.apply(console,Array.prototype.slice.call(arguments))},admin_log:function(){if(this.is_admin())return this.log(arguments)},annotate_out_links:function(e,t){return $(""+e+" a.outlink").each(function(){return $(this).attr("data-properties",t)})},decompose_url:function(t){var n,r,i,s,o,u,a,f;return a=t.split("#"),t=a[0],i=2<=a.length?e.call(a,1):[],r=i.join("#"),n=_.chain(r.split("&")).compact().map(function(e){return e.split("=")}).value(),f=t.split("?"),t=f[0],u=2<=f.length?e.call(f,1):[],o=u.join("?"),s=_.chain(o.split("&")).compact().map(function(e){return e.split("=")}).value(),[t,s,n]},build_url:function(e,t,n){var r,i,s;return s=this.decompose_url(e),e=s[0],i=s[1],r=s[2],t&&(i=i.concat(t)),n&&(r=r.concat(n)),i.length>0&&(e=e+"?"+_(i).map(function(e){return e.join("=")}).join("&")),r.length>0&&(e=e+"#"+_(r).map(function(e){return e.join("=")}).join("&")),e},from_hash_url:function(){var e,t,n;return t=window.location.hash.substring(1),e=_.map(t.split("&"),function(e){return e.split("=")}),n=_.reduce(e,function(e,t){return e[t[0]]=t[1],e},{}),n},ie6:function(){return $.browser.msie&&$.browser.version.match(/^6/)},supports_local_storage:function(){var e;try{return e="test_storage",localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(t){return!1}},supports_svg:function(){var e;return e="http://www.w3.org/2000/svg",!!document.createElementNS&&!!document.createElementNS(e,"svg").createSVGRect}}}.call(this);var $auvid,$request_id,$old_request_id,$old_start_time,Academia={set_gmtoffset:function(e){$(function(){$.post(e,{minutes:(new Date).getTimezoneOffset()})})},analytics:function(){var e="auvid",t=$.cookie(e);if(t==null){var n=Math.random(),r=$.sha1(""+$start_time+n);$.cookie(e,r,{path:"/",expires:30,domain:"."+$domain}),$auvid=r}else $auvid=t;window.$current_user==null?$request_id=$.sha1("r_"+$start_time).substr(0,9):$request_id=$current_user.request_id,this.record_hit_if_logged_out(),$make_live_connection&&this.socket_connect_and_emit(),$.cookie("from_cache","")},push_request_id:function(){if($old_request_id!=null)return;$old_request_id=$request_id,$old_start_time=$start_time,$start_time=(new Date).getTime(),$request_id=$.sha1("r_"+$start_time).substr(0,9)},pop_request_id:function(){if($old_request_id==null)return;$request_id=$old_request_id,$start_time=$old_start_time,$old_request_id=null},record_hit_if_logged_out:function(){$.cookie("user_id")==null&&this.record_hit({referrer:document.referrer,auvid:$auvid,request_id:$request_id})},record_hit:function(e){$.ajax({type:"POST",url:"/record_hit",data:e})},record_attachment_download:function(e){var t={auvid:$auvid,request_id:$request_id,attachment_id:e,page:0};$.ajax({type:"POST",url:"/inc_attachment_downloads/"+e,data:t,async:!1})},socket_connect_and_emit:function(){require(["http://cdnjs.cloudflare.com/ajax/libs/socket.io/0.8.4/socket.io.min.js"],function(){if(typeof io!="undefined"){if($rails_env=="development")var e=io.connect("live."+$domain+":82");else var e=io.connect("live."+$domain);e.on("connect",function(){data={a:$auvid,e:(new Date).getTime()-$start_time,r:$request_id},typeof $current_user!="undefined"&&$current_user.admin==1&&$a.log(data),e.emit("r",data)})}})},record_close:function(){var e={auvid:$auvid,elapsed_time:(new Date).getTime()-$start_time,request_id:$request_id};$.ajax({type:"POST",url:"/stop_live",async:!1,data:e})},report_on_unload:function(){var e=this;$h.windowAddEventListener("unload",function(){e.record_close()})},in_container_or_all:function(e,t){return"undefined"==typeof t?$(e):$(t).find(e)},magicker_default:function(e){var t=this.in_container_or_all("input.magicker-default",e);t.each(function(e){$(this).magicker_default($(this).data("magicker-default"))})},magic_defaults:function(e){this.in_container_or_all("input.magic-default",e).each(function(){var e=$(this),t=e.val();t&&(e.focus(function(){e.val()===t&&(e.trigger("magic-default-off"),e.val(""),e.removeClass("magic-default-on"),e.addClass("magic-default-off"))}),e.blur(function(){e.val()===""&&(e.trigger("magic-default-on"),e.val(t),e.removeClass("magic-default-off"),e.addClass("magic-default-on"))}))}),this.in_container_or_all("textarea.magic-default",e).each(function(){var e=$(this),t=e.text(),n=e.attr("rows");t&&(e.focus(function(){if(e.val()===t||e.text()===t)e.trigger("magic-default-off"),e.text(""),e.val(""),e.removeClass("magic-default-on"),e.addClass("magic-default-off")}),e.blur(function(){e.val()===""&&(e.trigger("magic-default-on"),e.text(t),e.val(t),e.attr("rows",n),e.removeClass("magic-default-off"),e.addClass("magic-default-on"))}))}),this.in_container_or_all("form.clear-magic-default",e).each(function(){var e=$(this);e.submit(function(){e.find(".magic-default").each(function(){var e=$(this);e.hasClass("magic-default-on")&&e.val("")})})})},hoverfix:function(e){this.in_container_or_all(".hoverfix",e).mouseover(function(){$(this).addClass("hover")}).mouseout(function(){$(this).removeClass("hover")})},load_async:function(e){var t=this.in_container_or_all(".load_async",e);t.each(function(e,t){var n=$(t),r=n.data("url");r&&$.ajax({url:r,complete:function(e){if(e.status==200||e.status==304)n.html(e.responseText).show(),Academia.all_behaviors(n)}})})},textarea_maxlength:function(e){this.in_container_or_all("textarea",e).each(function(){var e=$(this),t=e.attr("maxlength");t&&t>0&&e.keydown(function(){e.val().length>t&&e.val(e.val().substring(0,t))})})},textarea_enter_trigger:function(e){this.in_container_or_all("textarea.enter-trigger",e).each(function(){var e=$(this);e.keypress(function(t){return t.which===13?(e.parents("form").submit(),!1):!0})})},first_focus:function(e){this.in_container_or_all("input.first-focus, textarea.first-focus",e).focus()},autoexpand:function(e){var t=this.in_container_or_all("textarea.autoexpand",e),n=this.in_container_or_all("textarea.autoexpand_on_focus",e);t.autosize(),n.on("focus click",function(){$(this).autosize()})},tooltips:function(e){var t=this;req("tooltip",function(){t.in_container_or_all(".tooltip",e).tooltip()})},out_links:function(e){this.in_container_or_all("a.outlink",e).click(function(){return Academia.track_click(this.getAttribute("href"),this.getAttribute("data-properties"),!1),!0})},track_click:function(e,t,n){$.ajax({type:"POST",url:"/out_link",data:{url:e,properties:t},async:!!n})},single_submit:function(e){this.in_container_or_all("form.single_submit",e).single_submit()},time_time_ago_time_ago:function(e){this.in_container_or_all("time.time_ago",e).timeago()},retina_images:function(e){this.in_container_or_all("img.2x",e).retina({suffix:"-2x"})},url_behaviours:function(){},commaize_int:function(e){if(e==null||e=="")return e;var t=[];e=""+e;var n=(""+e).split("");n.reverse();while(n.length>0){var r=n.splice(0,3);r.reverse(),t.push(r.join(""))}return t.reverse(),t.join(",")},visible_top_banner:function(){$("#top_banner").is(":visible")&&$("body").css({"background-position":"0px 40px"})},init_banner_close_btn:function(){$("#top_banner .close_banner").click(function(e){e.preventDefault(),$("#top_banner").remove(),$("body").css({"background-position":"0px 0px"}),$.cookie("saw_petition_banner","1",{domain:$domain,path:"/"})})},format_search_result:function(e){var t="",n=e[0],r=e[1],i=e[3],s=e[4],o=e[7],u=e[8],a=i&&parseInt(i,10)>0,f=o&&$.trim(o).length>0;return r=="User"&&(u?t+="<img src='"+u+"' style='display: none'>":t+='<img src="http://cfassets3.academia.edu/images/tiny_no_pic.gif?711c5d3087805f6a1369cab512301405" style="display: none">'),t+=n,a&&s&&(t+=" (",a&&(t+=i+" "+s),t+=")"),f&&(t+=" <span class='ac_tag_class'>"+o+"</span>"),r=="ResearchInterest"&&(r="Research Interest"),r!="University"&&r!="User"&&r!="NavigationSearchResult"&&(t+=" <span class='ac_tag_class' style='display: none'>"+r+"</span>"),t},search_autocomplete_initialized:!1,search_autocomplete:function(){if(!Academia.search_autocomplete_initialized){var e=$("#new_search_field"),t=$("#content div"),n=$("#top_search_loader .tip");form=$("#new_search_box_form"),form.bind("submit",function(e){e.preventDefault()}),e.focus(function(){$("#top_search_loader").show(),e.css({borderColor:"#b3b3b3"})}),e.blur(function(){$("#top_search_loader").hide(),e.css({borderColor:"#000"})}),e.autocomplete("/ac_search",{benchmarkUrl:"/ac_search_benchmark",minChars:3,cacheLength:1,matchSubset:!1,delay:10,max:20,width:200,selectFirst:!0,resultsClass:"top_search_results",formatItem:Academia.format_search_result,distractor:"#top_search_loader_gif",scrollHeight:360,form:form,displayItem:function(e){return $h.decodeHTML(e)}}).result(function(t,n){window.location.href=n[6],e.val(""),e.focus()}),Academia.search_autocomplete_initialized=!0}},radio_buton_xor_text_input:function(e,t){var n=$(e),r=$(t);n.change(function(){n.each(function(){this.checked&&r.val("")})}),r.keyup(function(){r.val()!==""&&n.each(function(){this.checked=!1})})},create_feedback_popup:function(){var e=$("#feedback_link");e.click(function(e){e.preventDefault(),$w.boxover({iframe:"/feedback?boxy=iframe",title:"Give us some feedback",height:240})})},all_behaviors:function(e){Academia.magicker_default(e),Academia.magic_defaults(e),Academia.hoverfix(e),Academia.load_async(e),Academia.textarea_maxlength(e),Academia.textarea_enter_trigger(e),Academia.autoexpand(e),Academia.tooltips(e),Academia.first_focus(e),Academia.out_links(e),Academia.single_submit(e),Academia.time_time_ago_time_ago(e),Academia.retina_images(e),Academia.search_autocomplete(),Academia.visible_top_banner()}};$(document).ready(function(){Academia.all_behaviors(),Academia.analytics()});var JSRouteParser={components:[],callback:null,extraParams:{},create:function(e,t,n){var r=$x.object(this);return r.components=e,r.callback=t,n!==null&&(r.extraParams=n),r},run:function(e){var t=_.compact(e.split(/\//));return this.parse(this.components,t,this.extraParams)},parse:function(e,t,n){var r,i,s,o=1,u=e[0],a=t[0],f=this,l=function(){return f.callback(n),n};"undefined"==typeof n&&(n={});if(e.length===0||t.length===0)return e.length===0&&t.length===0?l():!1;r=u.match(/^(\*{1,2})(\w*)$/);if(r){s=r[1].length===2,i=r[2];if(s){if(e.length===1)return"undefined"!=typeof i&&(n[i]=t.join("/")),l()}else"undefined"!=typeof i&&(n[i]=a)}else if(u!==a)return!1;return this.parse(e.slice(1,e.length),t.slice(o,t.length),n)}},JSRouteGenerator={components:[],extraParams:{},create:function(e,t){var n=$x.object(this);return n.components=e,t!==null&&(n.extraParams=t),n},run:function(e){var t=$x.cloneWithoutMethods(e),n=$x.cloneWithoutMethods(this.extraParams);return this.generate(this.components,n,t,"")},generate:function(e,t,n,r){var i,s,o,u=e[0],a=function(){return r},f=function(e){r=r+"/"+e};if(e.length===0){var l=$x.getOwnPropertiesWithoutMethods(n),c=$x.getOwnPropertiesWithoutMethods(t);if(l.length===0)return a();if(c.length===0)return!1;var h,p;for(h=0;h<l.length;h++){p=l[h];if(t[p]===n[p])return delete t[p],delete n[p],this.generate([],t,n,r)}return!1}i=u.match(/^(\*{1,2})(\w*)$/);if(i){s=i[1].length===2,o=i[2];if(o==="string")return!1;if("undefined"==typeof n[o])return!1;f(n[o]),delete n[o];if(s)return $x.getOwnPropertiesWithoutMethods(n).length===0?a():!1}else f(u);return this.generate(e.slice(1,e.length),t,n,r)}},JSRoutes={parsers:[],generators:[],listeners:[],last_hash_path_set:null,hash_path_setter:null,register:function(e){e(this.connect)},listen:function(e){this.listeners.push(e)},clear:function(){this.parsers=[],this.generators=[]},connect:function(e,t,n){n||(n={});var r=JSRoutes.splitPathSpec(e);JSRoutes.parsers.push(JSRouteParser.create(r,t,n)),JSRoutes.generators.push(JSRouteGenerator.create(r,n))},splitPathSpec:function(e){var t=_.compact(e.split(/\//));return t},getHashPath:function(){var e=document.location.hash;return e?decodeURIComponent(e.replace(/^\#/,"")):""},setHashPath:function(e){e!==!1&&(JSRoutes.last_hash_path_set=e,e!==""&&(this.hash_path_setter===null?document.location.hash="#"+e:this.hash_path_setter(e)))},dispatchPath:function(e,t){var n,r=!1,i,s;for(i=0;i<this.parsers.length;i++){s=this.parsers[i];if(r=s.run(e)){n=!0;break}}return n?this.callListeners(r,e,!0):t&&t(e),n},dispatch:function(){return this.dispatchPath(this.getHashPath())},dispatchOrCall:function(e){return this.dispatchPath(this.getHashPath(),e)},generatePath:function(e){var t,n,r;for(t=0;t<this.generators.length;t++){n=this.generators[t],r=n.run(e);if(r!==!1)return this.callListeners(e,r,!1),r}return!1},anchor:function(e){this.setHashPath(this.generatePath(e))},callListeners:function(e,t,n){for(var r=0;r<this.listeners.length;r++)this.listeners[r](e,t,n)},go:function(e){this.setHashPath(e),this.dispatch()},dispatchIfChanged:function(){var e=this.getHashPath();this.last_hash_path_set!==e&&this.go(e)}};JSRoutes.parseUri=function(e){var t=JSRoutes.parseUri.options,n=t.parser[t.strictMode?"strict":"loose"].exec(e),r={},i=14;while(i--)r[t.key[i]]=n[i]||"";return r[t.q.name]={},r[t.key[12]].replace(t.q.parser,function(e,n,i){n&&(r[t.q.name][n]=i)}),r},JSRoutes.parseUri.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},function(){var e,t,n;t="facebook-button-login",e="facebook-button-connect",n=parent&&parent.location&&parent.location.href?parent.location.href:document.location.pathname===/\/(login|signup)/?"/":document.location.href,$(function(){return $("body").on("click","."+t,function(){var e=this;return $(this).removeClass(""+t),$(this).html("<img src='http://cfassets2.academia.edu/images/spinner.gif?03ce3dcc84af110e9da8699a841e5200'>"),NewRegistrationController.facebook_login(function(){return document.location.href=n},function(){return $(e).html("No matching account registered.<br/>Please <a href='/signup'>sign up</a> first.")})}),$("body").on("click","."+e,function(){return $(this).removeClass(""+e),$(this).html("<img src='http://cfassets2.academia.edu/images/spinner.gif?03ce3dcc84af110e9da8699a841e5200'>"),NewRegistrationController.facebook_login_callback(n)})})}.call(this);var Follow={init:function(e){var t;e==null?t=$(document):e.jquery?t=e:t=$(e),t.find(".follow_button").follow_button(),$(".follow_btn, .follow_btn_big, .follow_btn_big_170, .follow_user").hover(function(){var e="#"+$(this).attr("id")+"_hover";$(e).stop(),$(e).show(),$(e).animate({marginLeft:"-306px",opacity:"1.0"},300)},function(){var e="#"+$(this).attr("id")+"_hover";$(e).stop(),$(e).animate({marginLeft:"-300px",opacity:"0.0"},300),$(e).hide()}),t.find(".follow_btn_link").one("click",function(){var e=$(this),t=e.parents(".follow-me-button"),n=t.attr("rel"),r=parseInt(e.attr("rel"),10),i=t.attr("id");return Follow.follow(n,r,$current_user.public_secret,i)}),t.find(".user_strip .follow_user a").click(function(){var e=$(this),t=e.attr("data-id"),n=e.attr("rel"),r=e.parent().attr("id"),i="#"+r.replace("follow_me_message_","unfollow_me_");return $(i).fadeIn(),Follow.follow(n,t,$current_user.public_secret,r)}),t.find(".user_strip .unfollow_user a").click(function(){var e=$(this),t=e.attr("data-id"),n=e.parent().attr("id");return n="#"+n.replace("unfollow_me_","follow_me_message_"),$.post("/unfollow_user?id="+t),$(n).fadeIn(),e.fadeOut(),!1})},follow:function(e,t,n,r,i){return r||(r="follow-me"),i?i=="fade_in_unfollow"?$("#"+r).fadeOut("fast",function(){$(".unfollow_btn_big").fadeIn()}):$("#"+r).hide():$("#"+r).fadeOut("fast"),$.post("/followings",{"following[followee_id]":t,_public_secret:n},function(e){e.success||(e.message&&alert(e.message),$(".unfollow_btn_big").hide(),$("#"+r).show()),e.redirect&&(document.location=e.redirect)},"json"),!1},unfollow:function(e,t,n,r,i,s,o){return $w.flash("You are no longer following "+e,{nextTo:$("#"+r)},function(){$("#"+r).fadeOut()}),s!=null?$.post("/unfollow",{followee_id:s}):$.post("/followings/"+t,{_method:"delete",_public_secret:n},function(e){e.success||($("#"+i).slideDown("fast"),e.message&&alert("There was a problem: "+e.message))},"json"),!1},follow_user:function(e,t){Follow.post_follow(e,"POST",t)},unfollow_user:function(e,t){Follow.post_follow(e,"DELETE",t)},post_follow:function(e,t,n){$.ajax({url:$r.api_v0_user_following_index_path({user_id:e,subdomain_param:"api"}),type:"POST",data:{_method:t,_public_secret:$current_user.public_secret},success:function(){n&&n()}})},show_login_or_signup:function(e){return $("#"+e).slideDown("fast"),!1}};$(function(){Follow.init()}),function(){var e;e=function(e){var t,n,r;return t=$(e.data("container")),r=t.find(e.data("show")),n=t.find(e.data("hide")),{show:r,hide:n}},$(document).on("click","a[data-more-link-behavior=true]",function(e){var t;return e.preventDefault(),t=$(e.target),t.trigger("show_more")}),$(document).on("show_more","*",function(t){var n,r,i;return t.stopPropagation(),i=e($(t.target)),r=i.show,n=i.hide,n.addClass("hidden"),n.hide(),r.removeClass("hidden"),r.show()}),$(document).on("show_less","*",function(t){var n,r,i;return t.stopPropagation(),i=e($(t.target)),r=i.show,n=i.hide,r.addClass("hidden"),r.hide(),n.removeClass("hidden"),n.show()})}.call(this),$(function(){$("input[type=checkbox].select_all").each(function(e,t){var n=null;$(t.className.split(" ")).each(function(e,t){t.indexOf("select_all_group_")===0&&(n=t)});if(n){var r=$("input[type=checkbox]."+n).not(t);$(t).change(function(e){r.each(function(e,n){n.checked=t.checked})}),r.change(function(e){var n=!0;r.each(function(e,t){n=n&&t.checked}),t.checked=n})}})});var $w={flash:function(e,t,n){"undefined"==typeof t&&(t={}),t.message=e;var r=Widgets.Notification.create(t);r.flash(n,t)},confirm:function(e,t,n){"undefined"==typeof t&&(t={});var r;t.message=e,t.onYes=function(){r.fadeOutAndRemove("fast",n)},r=Widgets.YesNo.create(t),r.fadeIn()},boxover:function(e){var t=Widgets.BoxOver.create(e);return $("#overlay_background").fadeTo("fast",.6),t.show(),t},boxover_link:function(e,t,n){var r=$(e),i=r.attr
("href");i.match(/\?/)?i+="&boxy=iframe":i+="?boxy=iframe";var s=$(window).height(),o=Widgets.BoxOver.DEFAULT_TOP;n>s-o*2&&(o=10,n>s-66&&(n=s-66));var u={title:r.text(),iframe:i,width:t,height:n,top:o,loader_image_url:"http://cfassets0.academia.edu/images/friend_finder/loading2.gif?268dddb59b19d4fd7d0be83e67b419e2"};return $w.boxover(u)},prompt_login:function(e){var t=Widgets.Login.create(e);return t.show(),t},warning_bubble:function(e,t){var n;return t.message=e,n=Widgets.WarningBubble.create(t),n.fadeIn(),n},confirm_bubble:function(){var e,t;return typeof arguments[0]=="string"&&typeof arguments[1]=="string"?(t=arguments[2]||{},t.header=arguments[0],t.message=arguments[1],t.callback=arguments[3]):(t=arguments[1]||{},t.header=arguments[0],t.message=null,t.callback=arguments[2]),e=Widgets.ConfirmBubble.create(t),e.fadeIn(),e}},Widgets={};Widgets.Base={parent:null,open_widgets:[],inherit:function(e){var t=$x.extend($x.object(this),e);return t.parent=this,t},create:function(e){var t=$x.object(this);return t.init(e),t},target_element:null,init:function(e){this.target_element=e.nextTo;var t=e.down||10,n=e.along||0,r=$(this.target_element).offset();this.offset={left:r.left+n,top:r.top+t}},dom_element:null,j_element:null,definition:function(){return["div.base-widget"]},build:function(){this.dom_element=JSML.transform(this.definition()),this.j_element=$(this.dom_element),this.j_element.hide()},insert:function(){document.body.appendChild(this.dom_element)},remove:function(){var e=this.dom_element;e?e.parentNode.removeChild(e):$a.log("el wasn't defined")},position:function(){this.target_element&&this.j_element.css({position:"absolute",left:this.offset.left,top:this.offset.top})},show:function(){this.prepare(),this.j_element.show(),this.add_to_open_widgets()},fadeIn:function(){this.prepare(),this.j_element.fadeIn(),this.add_to_open_widgets()},hide:function(){$("#overlay_background").hide(),this.j_element.hide(),this.cleanup(),this.remove_from_open_widgets(),"function"==typeof this.after_hide_callback&&this.after_hide_callback()},fadeOut:function(){var e=this;this.j_element.fadeOut(function(){e.cleanup(),e.remove_from_open_widgets(),"function"==typeof e.after_hide_callback&&e.after_hide_callback()})},shake:function(e){e=typeof e!="undefined"?e:"5px";var t=this;t.j_element.animate({marginLeft:"-"+e},100,function(){t.j_element.animate({marginLeft:e},100,function(){t.j_element.animate({marginLeft:"0px"},100)})})},hide_all:function(){var e=Widgets.Base.open_widgets.slice();for(var t=0;t<e.length;t++)e[t].hide()},add_to_open_widgets:function(){Widgets.Base.open_widgets.push(this)},remove_from_open_widgets:function(){var e=Widgets.Base.open_widgets.indexOf(this);e>=0&&Widgets.Base.open_widgets.splice(e)},prepare:function(){this.insert(),this.position()},cleanup:function(){this.j_element.html(""),this.remove()},flash:function(e,t){"undefined"==typeof t&&(t={});var n=t.fadeInMS||100,r=t.visibleMS||400,i=t.fadeOutMS||400,s=this;s.prepare(),s.j_element.fadeIn(n,function(){setTimeout(function(){s.j_element.fadeOut(i,function(){s.cleanup(),e&&e()})},r)})},bind_fade_to_events:function(){var e=this,t=$.map(arguments,function(e){return typeof e[0]=="string"?$(e[0]):e[0]}),n=$.map(arguments,function(e){return e[1]}),r=function(){$.each(t,function(e,t){t.unbind(n[e],r)}),e.j_element.css("display")!=="none"&&e.fadeOut()};$.each(t,function(e,t){t.bind(n[e],r)})}},Widgets.Notification=Widgets.Base.inherit({message:"",init:function(e){this.parent.init(e),this.message=e.message,this.build()},definition:function(){return[".notification-widget",[".notification-widget-message",this.message]]}}),Widgets.Login=Widgets.Base.inherit({message:"",init:function(e){this.parent.init(e),this.message=e.message,this.build()},definition:function(){return[".notification-widget",[".notification-widget-message","Please ",["a",{href:"/login"},"log in"]," or ",["a",{href:"/signup"},"sign up"]," ",this.message]]}}),Widgets.WarningBubble=Widgets.Base.inherit({init:function(e){this.parent.init(e),this.message=e.message,this.alignment=e.alignment||"left",this.build()},definition:function(){return[".warning_bubble",["img",{src:"http://cfassets3.academia.edu/images/tiny_arrow.gif?a41c63f469408fefcccd90d0cf558a1b",style:this.alignment+": 10px"}],this.message]},position:function(){var e=this.j_element,t=this.target_element,n=this.alignment,r=t.offset().top+t.outerHeight()+9+"px",i;n==="left"?i=t.offset().left+"px":i=t.offset().left+t.outerWidth()-e.outerWidth()+"px",e.css({display:"none",position:"absolute",left:i,top:r})},shake_it:function(){var e=this.j_element;e.animate({marginLeft:"-5px"},100,function(){e.animate({marginLeft:"5px"},100,function(){e.animate({marginLeft:"0px"},100)})})}}),Widgets.ConfirmBubble=Widgets.Base.inherit({header:"Are you sure?",yes:"Confirm",no:"Cancel",init:function(e){this.parent.init(e),this.header=e.header?[".bubble_header",e.header]:"",this.message=e.message?[".bubble_message",e.message]:"",this.alignment=e.alignment||"left",this.callback=e.callback||function(){},this.build()},definition:function(){var e=this;return[".warning_bubble",["img",{src:"http://cfassets3.academia.edu/images/tiny_arrow.gif?a41c63f469408fefcccd90d0cf558a1b",style:e.alignment+": 10px"}],e.header,e.message,[".confirm_cancel",["a.no",{href:"#",onclick:function(){return e.fadeOut(),!1}},e.no]," ",["a.yes",{href:"#",onclick:function(){return e.fadeOut(),e.callback(),!1}},e.yes]]]},position:function(){var e=this.j_element,t=this.target_element,n=this.alignment,r=t.offset().top+t.outerHeight()+9+"px",i;n==="left"?i=t.offset().left+"px":i=t.offset().left+t.outerWidth()-e.outerWidth()+"px",e.css({display:"none",position:"absolute",left:i,top:r})}}),Widgets.BoxOver=Widgets.Base.inherit({url:null,internal_definition:null,type:null,title:null,width:null,height:null,top:null,positioning:null,loader_image_url:null,loader_image:null,DEFAULT_TOP:75,DEFAULT_WIDTH:500,DEFAULT_HEIGHT:300,init:function(e){"undefined"!=typeof e.ajax&&(this.type="ajax",this.url=e.ajax),"undefined"!=typeof e.iframe&&(this.type="iframe",this.url=e.iframe),"undefined"!=typeof e.dynamic&&(this.type="dynamic",this.internal_definition=e.dynamic),"undefined"!=typeof e.title&&(this.title=e.title),"undefined"!=typeof e.width?this.width=parseInt(e.width,10):this.width=this.DEFAULT_WIDTH,"undefined"!=typeof e.height?this.height=parseInt(e.height,10):this.height=this.DEFAULT_HEIGHT,"undefined"!=typeof e.top?this.top=parseInt(e.top,10):this.top=this.DEFAULT_TOP,"undefined"!=typeof e.loader_image_url&&(this.loader_image_url=e.loader_image_url,this.loader_image=$(new Image),this.loader_image.attr("src",this.loader_image_url)),"undefined"!=typeof e.after_hide&&(this.after_hide_callback=e.after_hide),e.positioning=="absolute"?(this.positioning="absolute",this.top+=$(window).scrollTop()):this.ensure_all_visible(),this.build()},ensure_all_visible:function(){var e=$(window).scrollTop(),t=$(window).height(),n=this.j_element,r=n?n.offset().top-e:this.top,i=n?n.height():this.height;r+i>t?(this.positioning="absolute",this.top+=e):this.positioning="fixed",this.j_element&&this.j_element.css({position:this.positioning,top:this.top})},content_width:function(){return this.width},content_height:function(){return this.height},set_height:function(e,t,n){var r=this,i=r.j_element.find(".container_title_bar").height();this.height=e,t||(t="fast");var s=function(){r.j_element.height(e+i),r.positioning=="fixed"&&r.ensure_all_visible(),n&&typeof n=="function"&&n()};this.type==="iframe"?r.j_element.find("iframe").animate({height:""+r.height+"px"},t,function(){r.j_element.css({height:""+r.height+"px"}),r.j_element.find("table").css({height:""+r.height+"px"}),s()}):r.j_element.animate({height:""+r.height+"px"},t,s)},position:function(){var e=this.j_element.width();this.width&&(e=this.width);var t=$(document).width();this.j_element.css({position:this.positioning,zIndex:100,left:""+(t-e)/2+"px",top:""+this.top+"px",height:""+this.height+"px",width:""+e+"px"}),this.type==="iframe"&&(this.j_element.find("table").css({width:""+this.width+"px",height:""+this.height+"px"}),this.j_element.find("iframe").css({width:""+this.content_width()+"px",height:""+this.height+"px"}))},show:function(){var e=this,t=$("#overlay_background");if(e.type==="ajax")e.j_element.find(".container_content").html(""),$.get(e.url,function(n){var r=document.createElement("div");r.innerHTML=n,e.j_element.find(".container_content").append(r),e.j_element.find(".boxover_widget_close").click(function(){return t.fadeOut("fast"),e.hide(),!1}),e.j_element.find(".boxover_widget_close_and_dispatch").click(function(){return e.hide(),JSRoutes.dispatchPath(this.href.replace(/^.*\#/,"")),!0}),e.prepare(),e.position(),e.j_element.show(),e.add_to_open_widgets()});else if(e.type==="iframe"){e.j_element.find(".container_content").html("");var n=$(document.createElement("iframe"));n.attr("src",e.url),e.j_element.find(".container_content").append(n),e.j_element.find(".boxover_widget_close").click(function(){return t.fadeOut("fast"),e.hide(),!1}),e.prepare(),e.position(),e.j_element.show(),e.add_to_open_widgets(),e.loader_image_url&&(e.show_wait_view(),n.load(function(){e.show_content_view()}))}else"dynamic"===e.type&&(e.j_element.find(".boxover_widget_close").click(function(){return t.fadeOut(),e.hide(),!1}),e.prepare(),e.position(),$("html,body").animate({scrollTop:0},400),e.j_element.show(),e.add_to_open_widgets())},show_wait_view:function(){var e=this;e.j_element.find(".container_content").hide();var t=e.j_element.find(".container_wait_content");t.css({height:""+e.height+"px","background-color":"#ffffff"});var n=this.loader_image.height()||12,r=this.loader_image.width()||40;t.append(this.loader_image),this.loader_image.css({"padding-top":""+e.content_height()/2-n/2+"px","padding-left":""+e.content_width()/2-r/2+"px"}),t.show()},show_content_view:function(){var e=this;e.j_element.find(".container_wait_content").hide(),e.j_element.find(".container_content").show()},definition:function(){var e=this,t=function(){var t="";return e.internal_definition&&(t=e.internal_definition),e.title!==null?["div.container_center",{valign:"top"},[".container_title_bar",[".container_close.boxover_widget_close",["i",{"class":"icon icon-remove icon-dark"},""]],[".container_title",e.title]],[".container_content",t],[".container_wait_content",""]]:["div.container_content",{valign:"top"},t]};return["#boxover_widget",t()]},hide_all_and_redirect_to:function(e){this.hide_all(),document.location=e}}),Widgets.YesNo={message:"Are you sure?",yes:"Confirm",no:"Cancel",create:function(e){function t(){}t.prototype=this;var n=new t;e.message&&(n.message=e.message),e.yes&&(n.yes=e.yes),e.no&&(n.no=e.no),e.onYes&&(n.onYes=e.onYes),e.onNo&&(n.onNo=e.onNo);if(e.nextTo){n.target=e.nextTo;var r=e.down||20,i=e.along||0,s=$(n.target).offset();n.offset={left:s.left+i,top:s.top+r}}else if(e.inCenterOf){n.target=e.inCenterOf;var o=$(n.target),s=o.offset();n.dimensions={width:o.width()/2,height:o.height()/2},n.offset={left:s.left+(o.width()-n.dimensions.width)/2,top:s.top+(o.height()-n.dimensions.height)/2}}return n.raw_el=JSML.transform(["div.yes-no-widget",["div.yes-no-widget-message",n.message],["div.yes-no-widget-buttons",["img.yes-no-spinner",{src:"http://cfassets2.academia.edu/images/spinner.gif?03ce3dcc84af110e9da8699a841e5200",style:"display: none;"}]," ",["a.no",{href:"#",onclick:function(){return n.onNo.apply(n),!1}},n.no]," ",["a.yes",{href:"#",onclick:function(){return n.onYes.apply(n),!1}},n.yes]]]),n.j_el=$(n.raw_el),n.j_el.css({position:"absolute",left:n.offset.left,top:n.offset.top,"z-index":1e5}),n.dimensions&&n.j_el.css({width:""+n.dimensions.width+"px",height:""+n.dimensions.height+"px"}),n.j_el.hide(),document.body.appendChild(n.raw_el),n},waiting:function(e){e?this.j_el.find(".yes-no-spinner").show():this.j_el.find(".yes-no-spinner").hide()},onNo:function(){return this.fadeOutAndRemove("fast"),!1},fadeIn:function(){this.j_el.fadeIn("fast")},fadeOutAndRemove:function(e,t){var n=this.j_el;n.fadeOut(e,function(){n.remove()}),t&&t()}};var JSML={transform:function(e){var t=e.shift(),n,r;t=t.replace(/#([^.]+)/,function(e,t){return n=t,""}),t=t.replace(/\.([^#]+)/,function(e,t){return r=t.replace("."," ","g"),""}),t===""&&(t="div");var i=document.createElement(t);n&&i.setAttribute("id",n),r&&(i.setAttribute("class",r),i.setAttribute("className",r));for(var s in e)if(e.hasOwnProperty(s)){var o=e[s];if(o.constructor===String)i.appendChild(document.createTextNode(o));else if(o.constructor===Array)i.appendChild(JSML.transform(o));else for(var u in o){var a=o[u];if(a.constructor===Function)i[u]=a;else if(a.constructor===String)i.setAttribute(u,o[u]),u==="class"?i.setAttribute("className",o[u]):u==="style"&&i.style&&i.style.setAttribute&&i.style.setAttribute("cssText",o[u]);else{var f="";for(var l in a)f+=l+": "+a[l]+"; ";i.setAttribute(u,f)}}}return i}};(function(){this._Base=function(){function e(){}return e.prototype.on=function(e,t){var n;return(n=this._events)==null&&(this._events={}),this._events[e]?this._events[e].push(t):this._events[e]=[t]},e.prototype.notify=function(e){var t;(t=this._events)==null&&(this._events={});if(this._events[e])return _.each(this._events[e],function(e){return e()})},e}()}).call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};this._BaseController=function(e){function n(e){var t=this;this.options=e!=null?e:{},$(function(){_.defaults(t.options,t.default_options),t._events={},t._init_container(t.options.container),t._init_elements(t.options.elements),t._init_listeners(t.options.listeners),t.initialize();if(t.options.after_initialize!=null)return t.options.after_initialize.call(t,t)})}return t(n,e),n.prototype._init_container=function(e){return this.container=_.isString(e)?$(e):e},n.prototype._init_elements=function(e){var t=this;this.elements={};if(e!=null)return _.each(e,function(e,n){return t.elements[n]=t.container!=null?t.container.find(e):$(e)})},n.prototype._init_listeners=function(e){var t=this;return _.each(e,function(e,n){return t.on(n,e)})},n.prototype.default_options={},n.prototype.initialize=function(){},n}(_Base)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};this._BaseModel=function(e){function n(e,t){this.data=e!=null?e:{},_.defaults(this.data,this.default_data),this._dirty=[],this.initialize()}return t(n,e),n.prototype.update=function(e,t){var n,r=this;return _.isString(e)&&(n={},n[e]=t,e=n),_.each(e,function(e,t){return r.data[t]=e,r._dirty.push(t)}),this.data},n.prototype.mark_clean=function(){return this._dirty=[],!0},n.prototype.dirty=function(e){return _.contains(this._dirty,e)},n.prototype.dirty_data=function(){var e,t=this;return e={},_.each(this.data,function(n,r){if(t.dirty(r))return e[r]=n}),e},n.prototype.default_data={},n.prototype.initialize=function(){},n}(_Base)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};this._BaseView=function(e){function n(e,t){this.options=e!=null?e:{},this.data=t!=null?t:{},_.defaults(this.options,this.default_options),_.defaults(this.data,this.default_data),this._events={},this._template=_.template(this.template),this.id=_.uniqueId(this.options.id_prefix+"_"),this.init_container(),this.initialize()}return t(n,e),n.prototype.init_container=function(){return this._container=_.template(this.options.container.template,{id:this.id,tag:this.options.container.tag}),this.container=$(this._container)},n.prototype.initialize=function(){},n.prototype.template="",n.prototype.default_options={id_prefix:"_view",container:{tag:"div",template:"<<%= tag %> id='<%= id %>'></<%= tag %>>"}},n.prototype.default_data={},n.prototype.update=function(e,t){var n;return _.isString(e)&&(n={},n[e]=t,e=n),_.extend(this.data,e),this.render()},n.prototype.render=function(){return this.container.html(this._template(this.data))},n.prototype.show=function(){return this.container.show()},n.prototype.hide=function(){return this.container.hide()},n.prototype.scroll_to=function(e){var t,n,r,i;return e==null&&(e=400),n=this.container.offset(),i=$(window).height(),t=20,r=n-t,r<0&&(r=0),$("html, body").animate({scrollTop:r},e)},n}(_Base)}.call(this),function(){this.Facebook={is_ready:!1,ready_listeners:[],connected_url:"/auth/connect",disconnected_url:"/auth/disconnect",check_url:"/auth/check",academia_facebook_contacts_path:"/FriendFinder/FacebookContacts",run_ready_listeners:function(){var e,t;this.is_ready=!0,e=void 0,t=[];while(e=this.ready_listeners.shift())t.push(e());return t},when_ready:function(e){return this.is_ready?e():this.ready_listeners.push(e)},retrieve_user_data:function(e){var t;return t=void 0,Facebook.when_ready(function(){return FB.getLoginStatus(function(n){if(n.authResponse)return t=n.authResponse.userID,FB.api("/"+t,function(n){return e({first_name:n.first_name,last_name:n.last_name,email:n.email?n.email:"",uid:t})})})})},call_with_auth_response:function(e,t){return Facebook.when_ready(function(){return FB.getLoginStatus(function(n){if(n.authResponse)return e(n.authResponse);if(t!=null)return t()})})},call_with_auth_response2:function(e,t){return Facebook.when_ready(function(){return FB.login(function(n){if(n.authResponse)return e(n.authResponse);if(t!=null)return t()},{scope:"email,offline_access"})})},get_login_status:function(e){return Facebook.when_ready(function(){return FB.getLoginStatus(e)})},show_contacts_or_login:function(e){var t=this;return this.call_with_auth_response(function(n){return e===!1?t.register_connected_and_call(function(){return t.show_contacts()}):t.show_contacts()},function(){return $("#connected_but_not_logged_in").show()})},show_contacts:function(){return $("#connected_but_not_logged_in").hide(),$("#successful_connection, .loading").show(),Facebook.load_facebook_contacts_from_academia("#contacts_container"),$(".registration_inner_content h4").html("Follow your friends to see their work in your News Feed"),$(".next_link").addClass("button blue"),$(".next_link").text("Save and Continue")},register_connected_and_call:function(e,t){var n,r=this;return typeof t=="undefined"&&(t=!1),n=function(t){return $.post(Facebook.connected_url,{provider:"facebook",_public_secret:$current_user.public_secret,uid:t.userID,"oauth[token]":t.accessToken,"oauth[expires]":t.expiresIn},function(){return $("#registering_spinner").hide(),$("#not_connected").hide(),e()})},$("#registering_spinner").show(),this.call_with_auth_response(function(e){return t?r.check_user_exists(e.userID,function(e){return $("#not_connected").html("<div class='info'>"+e.message+"</div>")},function(t){return n(e)}):n(e)})},check_user_exists:function(e,t,n){return $.post(Facebook.check_url,{_public_secret:$current_user.public_secret,provider:"facebook",uid:e},function(e){return e.exists?t(e):n(e)},"json")},register_connected_and_redirect_to:function(e){return this.register_connected_and_call(function(){return window.location=e},!0)},register_connected_and_show_contacts:function(){var e=this;return this.register_connected_and_call(function(){return e.show_contacts()},!0)},deregister_connected_and_reload:function(){return FB.login(function(e){$("#registering_spinner").show();if(e.authResponse)return FB.api({method:"auth.revokeAuthorization",params:{uid:e.authResponse.userID}},function(){return $.post(Facebook.disconnected_url,{_public_secret:$current_user.public_secret,provider:"facebook"},function(){return $("#registering_spinner").hide(),window.location.reload(!0)})})})},publish_story:function(e){return e.logged_in||(window.location=e.login_url+"?cp="+encodeURIComponent(document.location)),e.ensure_callback&&e.ensure_callback(e.element),Facebook.when_ready(function(){return FB.login(function(t){if(t.authResponse)return FB.ui({method:"stream.publish",message:e.args[0],attachment:e.args[1],action_links:e.args[2],user_prompt_message:e.args[3]},e.callback)})})},load_facebook_contacts_from_academia:function(e,t){var n;return n=$(e),n.find("img.spinner").show(),n.show(),n.load(this.academia_facebook_contacts_path+(t?"?recheck=true":""))}}}.call(this),function(){$.fn.extend({follow_button:function(){var e;return e=$.fn.follow_button,$(this).each(function(t,n){return e.init($(n))})}}),$.extend($.fn.follow_button,{follow_buttons:[],init:function(e){var t=this;return this.follow_buttons.push(e),e.unbind("click").click(function(n){var r,i;n.preventDefault();if(!window.$current_user)return r=e.data("fname"),alert("Please log in or sign up to follow "+r+"'s work");i=e.data("uid");if(i)return t.follow_user(i)})},follow_user:function(e){var t,n=this;return t={},t["following[followee_id]"]=e,t._public_secret=$current_user.public_secret,$.post("/followings",t,function(t){if(t&&t.success)return _.chain(n.follow_buttons).select(function(t){return t.data("uid")===e}).each(function(e){return e.fadeOut()})},"json")}})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};this.NavigationController=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){var e;return this.init_objects(),this.init_dropdowns(),this.init_menu(),e=this.options.local_store&&this.supports_local_storage(),this.get_notification_content(e),this.options.nav_open&&this.elements.counters.select("*[data-type=normal]").click(),this.add_notification_count_to_title()},n.prototype.init_objects=function(){return this.all_containers=[this.elements.normal_container,this.elements.account_menu]},n.prototype.add_notification_count_to_title=function(){var e;e=this.elements.counters.find("a").text();if(e>0)return e="("+e+") ",document.title=e+document.title},n.prototype.init_dropdowns=function(){var e=this;return _.each(this.all_containers,function(e){return e.click(function(e){return e.stopPropagation()})}),$(document).keydown(function(t){if(t.keyCode===27)return e.hide_all()}),this.elements.counters.click(function(t){return t.preventDefault(),e.handle_counter_click(t),!1})},n.prototype.init_menu=function(){var e,t,n,r=this;return n=this.elements,e=n.account_link,t=n.account_menu,this.options.ios?e.click(function(e){return t.toggle()}):_.each([e,t],function(n){return n.hover(function(n){t.data("hovered",!0);if(!e.hasClass("account_open"))return r.hide_all(),t.fadeIn(200),e.addClass("account_open")},function(n){return t.data("hovered",!1),_.delay(function(){if(!t.data("hovered"))return t.fadeOut(200),e.removeClass("account_open")},1e3)})})},n.prototype.handle_counter_click=function(e){var t,n,r,i,s,o,u=this;return t=$(e.currentTarget),n=t.find("a"),o=t.data("type"),i=t.data("count"),i&&n.html()<=5&&(n.html(i),t.data("count",null)),r=this.elements.normal_container,r.is(":hidden")?(this.hide_all(),s=this.elements.navigation_container.position().left-372+t.width()/2,r.css({left:""+s+"px"}),r.fadeIn(200),this.mark_as_read(t,r),$("body").click(function(e){return u.hide_all()}),$.post("/notifications/clear/"+o)):(this.mark_as_read(t,r),this.hide_all())},n.prototype.mark_as_read=function(e,t){return e.find("a").html("0"),document.title=document.title.replace(/^.*?(?=[A-Z][a-z])/g,""),e.addClass("zero"),t.find(".notification_message").addClass("read")},n.prototype.get_notification_content=function(e){return e&&localStorage.notifications&&!this.options.unread_messages?this.local_load_notification_content():this.lazy_load_notification_content(e)},n.prototype.local_load_notification_content=function(){var e;return $a.is_logged_in&&$current_user.admin&&$a.log("Getting notifications from localStorage!"),e=jQuery.parseJSON(localStorage.notifications),this.populate_notification_content(e)},n.prototype.lazy_load_notification_content=function(e){var t=this;return $.get("/notifications.json",{},function(n){var r;return e&&(localStorage.notifications=n),r=jQuery.parseJSON(n),t.populate_notification_content(r)})},n.prototype.populate_notification_content=function(e){var t,n,r;r=this.elements,n=r.normal_container,t=r.counters;if(n.data("loaded")!==!0)return n.html(e),Follow.init(n)},n.prototype.hide_all=function(){return _.each(this.all_containers,function(e){return e.hide()}),this.elements.account_link.removeClass("account_open"),$("body").unbind("click")},n.prototype.supports_local_storage=function(){try{return window.localStorage!==null&&localStorage}catch(e){return!1}},n}(_BaseController),this.LoggedOutNavigationController=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){var e,t,n,r,i,s,o=this;return s=this.elements,i=s.link,e=s.background,r=s.form,n=s.field,t=s.close,i.click(function(t){if(!$.browser.msie)return t.preventDefault(),e.fadeIn(100,function(){return r.fadeIn(100,function(){return n.focus()})})}),t.click(function(t){return t.preventDefault(),r.fadeOut(200,function(){return e.fadeOut(300)})})},n}(_BaseController),this.Navigation=NavigationController}.call(this);var AncientResource={set_create_url:function(e){this.create_url=e},set_url:function(e){this.url=e},set_xsrf_token:function(e){this.xsrf_token=e},init:function(e,t){var n=$x.object(this);return n.set_url(e),n.set_xsrf_token(t),n},init_collection:function(e,t){var n=$x.object(this);return n.set_create_url(e),n.set_xsrf_token(t),n},send:function(e,t,n,r,i){var s=this;s.xsrf_token&&(n._public_secret=s.xsrf_token),$.ajax({type:e,url:t,data:n,dataType:"json",async:!i,success:function(e){r.apply(null,e)},error:function(){r.apply(null,s.fatal_error_data())}})},create:function(e,t,n){this.send("POST",this.create_url,e,t,n)},destroy:function(e,t){this.send("POST",this.url,{_method:"delete"},e,t)},fatal_error_data:function(){return[!1,null,[["fatal",""]]]},is_fatal_error:function(e){return e.length===1&&e[0][0]==="fatal"}},AncientResourceController=BaseController.inherit({init:function(e){return e.xsrf_token&&(this.xsrf_token=e.xsrf_token),e.collection_url&&this.init_collection(e.collection_url),e.instance_url&&this.init_instance(e.instance_url),e.create_params?this.create_params=e.create_params:this.create_params={},this.protocall("init",e),this},init_instance:function(e){return this.instance=AncientResource.init(e,this.xsrf_token),this},init_collection:function(e){return this.collection=AncientResource.init_collection(e,this.xsrf_token),this},make:function(e){var t=this;return t.collection&&t.collection.create(t.create_params,e),t},unmake:function(e){var t=this;return t.instance&&t.instance.destroy(e),t}});(function(){window.BoxyLoginController=BaseController.inherit({init_behaviors:function(){return this.init_links(),this.init_spinners(),this.init_reset_form()},init_links:function(){var e=this;return this.elements.reset_link.click(function(t){return t.preventDefault(),e.elements.login_form.hide(),e.elements.reset_form.show(),$(document).trigger("set_iframe_size")}),this.elements.cancel_link.click(function(t){return t.preventDefault(),e.elements.reset_form.hide(),e.elements.login_form.show(),$(document).trigger("set_iframe_size")})},init_spinners:function(){var e=this;return this.elements.container.find("form").submit(function(){return e.elements.spinners.show()})},init_reset_form:function(){var e=this;return this.elements.reset_form.submit(function(t){return t.preventDefault(),$.ajax({type:"POST",url:e.elements.reset_form.attr("action"),data:{email:e.elements.reset_email.val()},dataType:"json",success:function(t){var n;return n=t[0],e.elements.spinners.hide(),n?parent.SignupWallController&&parent.SignupWallController.boxover_widget?parent.SignupWallController.boxover_widget.hide_all():window.location.reload():(e.elements.reset_text.text(t[2].message),e.elements.reset_text.css({color:"red"}))}})})}})}).call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};$x.ensureNamespace("Documents"),this.c.Documents.Download=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.default_options={loader_img:"http://cfassets0.academia.edu/images/friend_finder/loading2.gif?268dddb59b19d4fd7d0be83e67b419e2",boxy_height:"200px",title:"You must be logged in to download"},n.prototype.initialize=function(){var e=this;return $(document).on("click",this.options.selector,function(t){var n,r;n=$(t.currentTarget),r=n.data("download");if(r)return typeof $current_user!="undefined"&&$current_user!==null||r.always_allow_download||$a.ie6()?(e.inc_attachment_download(r.attachment_id),!0):(e.show_boxy(r),!1)})},n.prototype.show_boxy=function(e){var t;return t=this.build_url(e),this.create_boxy(t),this.listen_for_resize()},n.prototype.build_url=function(e){var t,n;return t="/signup_wall",n=[],e.redirect_to&&n.push(["cp",encodeURIComponent(e.redirect_to)]),n.push(["a_id",e.attachment_id]),n.push(["boxy","iframe"]),n.push(["force_doc_domain",$no_document_domain?"no":"yes"]),n.push(["random",String(Math.floor(Math.random()*1e9))]),$a.build_url(t,n,[["a_id",e.attachment_id]])},n.prototype.create_boxy=function(e){return this.boxy&&this.boxy.hide_all(),this.boxy=$w.boxover({iframe:e,title:this.options.title,top:"100px",width:"512px",height:this.options.boxy_height,loader_image_url:this.options.loader_img})},n.prototype.listen_for_resize=function(){var e=this;return $(document).on("resize_boxy",function(t,n){if(n)return e.boxy.set_height(n)})},n.prototype.inc_attachment_download=function(e){return Academia.record_attachment_download(e)},n}(_BaseController)}.call(this);var FormErrorsView=BaseView.inherit({structure:function(e,t){var n="Sorry, there ";n+=e.length>1?"were some problems:":"was a problem:";var r=["div",["p.error_headline",n]];for(var i=0;i<e.length;i++){var s="";t&&(s+=$h.capitalize(e[i][0])+" "),s+=e[i][1]+".",r.push(["p.error_message",s])}return r}}),FormController=BaseController.inherit({init_behaviors:function(){var e=this;this.elements.form.single_submit(),this.elements.form.submit(function(){return e.show_submitting(),e.submit_form(),!1}),this.init_form_behaviors()},show_submitting:function(){this.elements.form.find(".submit_spinner").show()},hide_submitting:function(){this.elements.form.find(".submit_spinner").hide()},init_form_behaviors:function(){},submit_form:function(){var e=this;this.elements.form.ajaxSubmit({dataType:"json",error:function(t,n,r){e.hide_submitting(),e.handle_service_error(t,n,r)},success:function(t){e.hide_submitting();if(t[0]){var n=t[1].fbdata;n&&n.fb_prompt?(n.callback=function(){e.handle_success(t[1])},Facebook.publish_story(n)):e.handle_success(t[1])}else e.handle_error(t[1],t[2])}})},handle_service_error:function(e,t,n){$e.report_error(t,"","")},handle_error:function(e,t){this.highlight_error_fields(t);if(this.elements.errors_container){var n=FormErrorsView.create(this.elements.errors_container);n.show(t,!this.options.custom_error_messages),n.scroll_to()}},handle_success:function(e){this.options.in_boxy?window.parent.on_boxover_success&&window.parent.on_boxover_success(e):e.url&&(document.location.href=e.url)},highlight_error_fields:function(e){}}),FailsafeFormController=Base.inherit({init:function(e){return this.form_element=e,this},failsafe_submit:function(e){var t=this;return $w.confirm(e,{nextTo:t.form_element},function(){t.form_element.appendChild(JSML.transform(["input",{type:"hidden",name:"_do_it",value:"now"}])),t.form_element.submit()}),!1}});(function(){var e;e=0,this.GlobalIncrementor={next:function(){return++e}}}).call(this),function(){$h.windowAddEventListener=function(e,t,n){return window.addEventListener?window.addEventListener(e,t,n):window.attachEvent("on"+e,t)}}.call(this),jade=function(e){function t(e){return e!=null}return Array.isArray||(Array.isArray=function(e){return"[object Array]"==Object.prototype.toString.call(e)}),Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}),e.merge=function(n,r){var i=n["class"],s=r["class"];if(i||s)i=i||[],s=s||[],Array.isArray(i)||(i=[i]),Array.isArray(s)||(s=[s]),i=i.filter(t),s=s.filter(t),n["class"]=i.concat(s).join(" ");for(var o in r)o!="class"&&(n[o]=r[o]);return n},e.attrs=function(n,r){var i=[],s=n.terse;delete n.terse;var o=Object.keys(n),u=o.length;if(u){i.push("");for(var a=0;a<u;++a){var f=o[a],l=n[f];"boolean"==typeof l||null==l?l&&(s?i.push
(f):i.push(f+'="'+f+'"')):0==f.indexOf("data")&&"string"!=typeof l?i.push(f+"='"+JSON.stringify(l)+"'"):"class"==f&&Array.isArray(l)?i.push(f+'="'+e.escape(l.join(" "))+'"'):r&&r[f]?i.push(f+'="'+e.escape(l)+'"'):i.push(f+'="'+l+'"')}}return i.join(" ")},e.escape=function(t){return String(t).replace(/&(?!(\w+|\#\d+);)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},e.rethrow=function(t,n,r){if(!n)throw t;var i=3,s=require("fs").readFileSync(n,"utf8"),o=s.split("\n"),u=Math.max(r-i,0),a=Math.min(o.length,r+i),i=o.slice(u,a).map(function(e,t){var n=t+u+1;return(n==r?"  > ":"    ")+n+"| "+e}).join("\n");throw t.path=n,t.message=(n||"Jade")+":"+r+"\n"+i+"\n\n"+t.message,t},e}({}),function(){this.MongoLog=function(){function t(e,t){this.method=e,this.args=t}var e;return e="/mongo_log_client_side",t.prototype.start=function(){return this.started=new Date},t.prototype.finish=function(t){var n;return n=new Date-this.started,$.post(e,{method:this.method,arguments:this.args,result:t,duration:n/1e3})},t}()}.call(this),function(){this.NewRegistrationController=BaseController.inherit({init_behaviors:function(){return NewRegistrationController._ref=this,this.init_provided_fields(),this.resource=new ResourceController({collection:{url:this.options.url}}),this.init_form(),this.init_link()},init_provided_fields:function(){return _.each(this.options.fields,function(e,t){return $(t).val(e)})},init_form:function(){var e=this;return this.elements.form.single_submit_with_callback(function(t,n){return e.handle_submission(t,n)})},handle_submission:function(e,t){var n=this;return this.resource.create_params=this.elements.form.serializeObject(),this.resource.make(function(e,r,i){return n.elements.spinner.hide(),t(),e&&n.options.parent_redirect?parent.location.href="/StartRegPath":e?document.location.href="/StartRegPath":n.resource.collection.is_fatal_error(i)?alert("Oops... Something just went wrong! We're taking a look at the issue right now. Please try again in a few minutes."):($(".inline_error").remove(),_.each(i,function(e){var t,n,r,i;return i=e[0],n=e[1],t="<p class='inline_error'>"+n+"</p>",r=$("input[name='"+i+"']"),r.addClass("input_error"),r.after(t)}),n.elements.facebook_success.hide(),$(document).trigger("set_iframe_size"))}),this.elements.spinner.show(),!1},init_link:function(){var e=this;return this.elements.show_form_link.click(function(t){return t.preventDefault(),e.elements.facebook_button.hide(),e.elements.show_form_link.hide(),e.elements.form.show(),$(document).trigger("set_iframe_size")})},facebook_login_callback:function(e){var t;return t=document.location.href,this.facebook_login(function(t){return parent.location=e!=null?e:parent.location},function(e){return Facebook.retrieve_user_data(function(e){var n;return n=[],n.push(["user_facebook_uid",e.uid]),n.push(["first_name",e.first_name]),n.push(["last_name",e.last_name]),n.push(["email",e.email]),document.location.href=$a.build_url(t,n)})})},facebook_login:function(e,t){return Facebook.call_with_auth_response2(function(n){var r;return r={provider:"facebook",oauth:{token:n.accessToken,expires:n.expiresIn}},$.post("/registrations",r,function(n){return n[0]?e(n):t(n)},"json")})}})}.call(this);if($.browser.msie&&$.browser.version<=7){var supersleight=function(){var e=!1,t=!0,n="http://cfassets5.academia.edu/images/x.gif?325472601571f31e1bf00674c368d335",r=/x\.gif$/i,i=function(){e?e=document.getElementById(e):e=document;for(var n=e.all.length-1,r=null;r=e.all[n];n--)r.currentStyle.backgroundImage.match(/\.png/i)!==null&&s(r),r.tagName=="IMG"&&r.src.match(/\.png$/i)!==null&&o(r),t&&(r.tagName=="A"||r.tagName=="INPUT")&&r.style.position===""&&(r.style.position="relative")},s=function(e){var t="scale",r=e.currentStyle.backgroundImage,i=r.substring(5,r.length-2);e.currentStyle.backgroundRepeat=="no-repeat"&&(t="crop"),e.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+i+"', sizingMethod='"+t+"')",e.style.backgroundImage="url("+n+")"},o=function(e){var t=e.src;e.style.width=e.width+"px",e.style.height=e.height+"px",e.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+t+"', sizingMethod='scale')",e.src=n},u=function(e){var t=window.onload;typeof window.onload!="function"?window.onload=e:window.onload=function(){t&&t(),e()}};return{init:function(){u(i)},limitTo:function(t){e=t},run:function(){i()}}}();supersleight.init()}(function(){var e,t,n,r={}.hasOwnProperty,i=function(e,t){function i(){this.constructor=e}for(var n in t)r.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};n=function(){function e(e,t){this.url=e,t.xsrf_token!=null&&(this.xsrf_token=t.xsrf_token),t.actions!=null&&(this.actions=t.actions)}return e.prototype.send=function(e,t,n,r,i){var s=this;return this.xsrf_token!=null&&(n._public_secret=this.xsrf_token),$.ajax({type:e,url:t,data:n,dataType:"json",async:!i,success:function(e){return r.apply(null,e)},error:function(){return r.apply(null,s.fatal_error_data())}})},e.prototype.call=function(e,t,n,r){var i,s,o;if(this.actions!=null&&(i=this.actions[e])&&(o=i.url))return s=(i.method||"get").toLowerCase(),s!=="post"&&s!=="get"&&(t._method=s,s="POST"),this.send(s.toUpperCase(),o,t,n,r);throw"No such custom action: "+e},e.prototype.fatal_error_data=function(){return[!1,null,[["fatal",""]]]},e.prototype.is_fatal_error=function(e){return e.length===1&&e[0][0]==="fatal"},e}(),e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return i(t,e),t.prototype.create=function(e,t,n){return this.send("POST",this.url,e,t,n)},t}(n),t=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return i(t,e),t.prototype.destroy=function(e,t){return this.send("POST",this.url,{_method:"delete"},e,t)},t}(n),window.Resource=n,window.InstanceResource=t,window.CollectionResource=e}).call(this),function(){this.ResourceController=function(){function e(e){e.xsrf_token!=null&&(this.xsrf_token=e.xsrf_token),e.collection!=null&&this.init_collection(e.collection),e.instance!=null&&this.init_instance(e.instance),e.create_params!=null?this.create_params=e.create_params:this.create_params={}}return e.prototype.init_instance=function(e){if(e.url!=null)return this.instance=new InstanceResource(e.url,{xsrf_token:this.xsrf_token,actions:e.actions})},e.prototype.init_collection=function(e){if(e.url!=null)return this.collection=new CollectionResource(e.url,{xsrf_token:this.xsrf_token,actions:e.actions})},e.prototype.call_on_instance=function(e,t,n,r){if(this.instance!=null)return this.instance.call(e,t,n,r)},e.prototype.call_on_collection=function(e,t,n,r){if(this.collection!=null)return this.collection.call(e,t,n,r)},e.prototype.make=function(e,t){if(this.collection!=null)return this.collection.create(this.create_params,e,t)},e.prototype.unmake=function(e,t){if(this.instance!=null)return this.instance.destroy(e,t)},e}()}.call(this),function(){this.SignupWallController=BaseController.inherit({boxover_widget:null,init_behaviors:function(){this.init_resize(),this.elements.signup_container&&this.init_signup_and_login_buttons();if(this.options.resize_on_load)return this.trigger_resize()},init_signup_and_login_buttons:function(){var e,t=this;return e=this.elements,e.login_button.click(function(n){return n.preventDefault(),e.signup_container.hide(),e.login_container.show(),t.trigger_resize()}),e.signup_button.click(function(t){return t.preventDefault(),e.login_container.hide(),e.signup_container.show(),this.trigger_resize()})},init_resize:function(){var e=this;return $(document).bind("set_iframe_size",function(){return e.trigger_resize()})},trigger_resize:function(){return top.$(top.document).trigger("resize_boxy",this.new_height())},new_height:function(){var e;return e=90,$("body").height()+e}})}.call(this),function(){var e;e=function(e,t){return _.debounce(t,e)},this.WorkViewCounts={pending_ids:[],queue:function(e,t){return this.pending_ids.push({work_id:e,callback:t}),this.retrieve()},retrieve:e(100,function(){var e,t,n=this;return t=this.pending_ids,e=_.uniq(_.pluck(t,"work_id")),$.ajax({url:$r.api_v0_works_views_url({work_ids:e}),dataType:"jsonp",success:function(e){return _.each(e.views,function(e,n){var r;return n=parseInt(n),r=_.select(t,function(e){return e.work_id===n}),_.each(r,function(t){return t.callback(e)})})}}),this.pending_ids=[]})}}.call(this);